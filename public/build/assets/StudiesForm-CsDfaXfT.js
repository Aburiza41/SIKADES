import{r as s,j as e,a as q}from"./app-cnLqKnWv.js";import{a as J,b as z,c as L}from"./index-CyDsHmf4.js";import{S as Q}from"./react-select.esm-kjDh-dq3.js";import{S as r}from"./sweetalert2.esm.all-LHqzTR4y.js";import{m as d}from"./proxy-0toHJmZX.js";import{A as O}from"./index-CSb7vC3W.js";import"./iconBase-CMF4PMHw.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";function re({studies:g=[],setStudies:B=()=>{},officialStudies:i=[],setOfficialStudies:o=()=>{}}){const[I,v]=s.useState(!1),[K,w]=s.useState(!1),[m,S]=s.useState(""),[C,T]=s.useState(""),[c,u]=s.useState(null),[x,p]=s.useState(""),[_,h]=s.useState(""),[D,b]=s.useState(""),[j,y]=s.useState(""),[A,N]=s.useState(""),[F,k]=s.useState(null),[n,M]=s.useState(null),f=s.useMemo(()=>g.map(a=>({value:a.id,label:a.name})),[g]);s.useEffect(()=>{if(n!==null&&i[n]){const a=i[n],t=f.find(l=>l.value===a.study_id);t&&u(t),p(a.nama_sekolah||""),h(a.alamat_sekolah||""),b(a.jurusan||""),y(a.tahun_masuk||""),N(a.tahun_keluar||""),k(a.dokumen||null)}},[n,i,f]);const R=()=>v(!0),P=()=>{v(!1),S(""),T("")},E=(a=null)=>{M(a),w(!0),a===null&&(u(null),p(""),h(""),b(""),y(""),N(""),k(null))},H=()=>{w(!1),M(null)},G=async()=>{if(!m.trim()){r.fire("Error","Judul pendidikan tidak boleh kosong!","error");return}try{const a=await q.post("/village/official/study/store",{title:m,description:C});if(a.data.success){const t={id:a.data.data.id,name:a.data.data.title,description:a.data.data.description};B(l=>[...l,t]),P(),r.fire("Sukses","Jenis pendidikan berhasil ditambahkan","success")}}catch{r.fire("Error","Gagal menambahkan jenis pendidikan","error")}},U=()=>{var t;if(!c||!x||!j){r.fire("Error","Harap isi data wajib!","error");return}const a={study_id:c.value,study_name:c.label,nama_sekolah:x,alamat_sekolah:_,jurusan:D,tahun_masuk:j,tahun_keluar:A,dokumen:F,...((t=i[n])==null?void 0:t.study)&&{study:i[n].study}};if(n!==null){const l=[...i];l[n]=a,o(l)}else o(l=>[...l,a]);H()},Y=a=>{r.fire({title:"Hapus Data?",text:"Data tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(t=>{t.isConfirmed&&(o(l=>l.filter((V,$)=>$!==a)),r.fire("Terhapus!","Data berhasil dihapus.","success"))})};return e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white w-full p-4 shadow rounded-lg mt-8",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center border-b pb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-700",children:"E. Formulir Riwayat Pendidikan"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Isi riwayat pendidikan pejabat desa"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:R,className:"flex items-center px-4 py-2 bg-blue-500 text-white rounded-md",children:[e.jsx(J,{className:"mr-2"})," Jenis Pendidikan"]}),e.jsxs(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>E(),className:"flex items-center px-4 py-2 bg-green-500 text-white rounded-md",children:[e.jsx(J,{className:"mr-2"})," Tambah Data"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Pendidikan"}),e.jsx("th",{className:"px-4 py-3",children:"Nama Sekolah"}),e.jsx("th",{className:"px-4 py-3",children:"Alamat"}),e.jsx("th",{className:"px-4 py-3",children:"Jurusan"}),e.jsx("th",{className:"px-4 py-3",children:"Tahun Masuk"}),e.jsx("th",{className:"px-4 py-3",children:"Tahun Keluar"}),e.jsx("th",{className:"px-4 py-3",children:"Aksi"})]})}),e.jsx("tbody",{children:i.length>0?i.map((a,t)=>{var l;return e.jsxs("tr",{className:"bg-white border-b",children:[e.jsx("td",{className:"px-4 py-3",children:a.study_name||((l=a.study)==null?void 0:l.name)}),e.jsx("td",{className:"px-4 py-3",children:a.nama_sekolah}),e.jsx("td",{className:"px-4 py-3",children:a.alamat_sekolah||"-"}),e.jsx("td",{className:"px-4 py-3",children:a.jurusan||"-"}),e.jsx("td",{className:"px-4 py-3",children:a.tahun_masuk}),e.jsx("td",{className:"px-4 py-3",children:a.tahun_keluar||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>E(t),className:"flex items-center px-2 py-1 bg-yellow-500 text-white rounded-md",children:[e.jsx(z,{className:"mr-1"})," Edit"]}),e.jsxs("button",{onClick:()=>Y(t),className:"flex items-center px-2 py-1 bg-red-500 text-white rounded-md",children:[e.jsx(L,{className:"mr-1"})," Hapus"]})]})})]},t)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",className:"px-4 py-3 text-center",children:"Tidak ada data pendidikan"})})})]})})]}),e.jsx(O,{children:I&&e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs(d.div,{initial:{y:-20},animate:{y:0},className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Tambah Jenis Pendidikan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Judul"}),e.jsx("input",{type:"text",value:m,onChange:a=>S(a.target.value),className:"w-full p-2 border rounded-md",placeholder:"Contoh: SMA"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Deskripsi"}),e.jsx("textarea",{value:C,onChange:a=>T(a.target.value),className:"w-full p-2 border rounded-md",rows:3,placeholder:"Deskripsi pendidikan"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{onClick:P,className:"px-4 py-2 bg-gray-500 text-white rounded-md",children:"Batal"}),e.jsx("button",{onClick:G,className:"px-4 py-2 bg-blue-500 text-white rounded-md",children:"Simpan"})]})]})})}),e.jsx(O,{children:K&&e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:e.jsxs(d.div,{initial:{y:-20},animate:{y:0},className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:n!==null?"Edit Pendidikan":"Tambah Pendidikan"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Jenjang Pendidikan"}),e.jsx(Q,{options:f,value:c,onChange:u,placeholder:"Pilih jenjang",className:"basic-single",classNamePrefix:"select",isClearable:!0,isSearchable:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Nama Sekolah"}),e.jsx("input",{type:"text",value:x,onChange:a=>p(a.target.value),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alamat Sekolah"}),e.jsx("input",{type:"text",value:_,onChange:a=>h(a.target.value),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Jurusan"}),e.jsx("input",{type:"text",value:D,onChange:a=>b(a.target.value),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tahun Masuk"}),e.jsx("input",{type:"number",value:j,onChange:a=>y(a.target.value),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tahun Keluar"}),e.jsx("input",{type:"number",value:A,onChange:a=>N(a.target.value),className:"w-full p-2 border rounded-md"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Dokumen"}),e.jsx("input",{type:"file",onChange:a=>k(a.target.files[0]),className:"w-full p-2 border rounded-md"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[e.jsx("button",{onClick:H,className:"px-4 py-2 bg-gray-500 text-white rounded-md",children:"Batal"}),e.jsx("button",{onClick:U,className:"px-4 py-2 bg-blue-500 text-white rounded-md",children:n!==null?"Update":"Simpan"})]})]})})})]})}export{re as default};
