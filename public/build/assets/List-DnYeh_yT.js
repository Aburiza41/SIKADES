import{r as a,j as e}from"./app-cnLqKnWv.js";import{I as F,J as z,K as V,G as W,L as Y,M as Q,N as X}from"./index-sj701c6h.js";import{u as y,w as Z}from"./xlsx-5rFX-EW9.js";import{S as R}from"./react-select.esm-kjDh-dq3.js";import{l as v}from"./lodash-Cij6ey_I.js";import{S as u}from"./sweetalert2.esm.all-LHqzTR4y.js";import{m as x}from"./proxy-0toHJmZX.js";import"./iconBase-CMF4PMHw.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";function pe({villages:s,fetchData:g,loading:T,onEdit:D,onDelete:K,onView:L}){var C;const[h,A]=a.useState(""),[c,G]=a.useState(null),[d,f]=a.useState(null),[H,I]=a.useState([]),[O,N]=a.useState([]),[o,k]=a.useState((s==null?void 0:s.current_page)||1),[p,U]=a.useState((s==null?void 0:s.per_page)||10),[b,J]=a.useState("id"),[m,$]=a.useState("asc");(C=document.querySelector('meta[name="csrf-token"]'))!=null&&C.getAttribute("content");const S=a.useCallback(v.debounce(t=>g(t),300),[g]);a.useEffect(()=>{fetch("/local/regencies",{headers:{Accept:"application/json"}}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>{t.success?I(t.data):(console.error("Error fetching regencies:",t.message),u.fire("Error",t.message||"Gagal mengambil data kabupaten.","error"))}).catch(t=>{console.error("Error fetching regencies:",t),u.fire("Error","Gagal mengambil data kabupaten.","error")})},[]),a.useEffect(()=>{c?fetch(`/local/districts/${c.value}`,{headers:{Accept:"application/json"}}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>{t.success?N(t.data):(console.error("Error fetching districts:",t.message),u.fire("Error",t.message||"Gagal mengambil data kecamatan.","error"))}).catch(t=>{console.error("Error fetching districts:",t),u.fire("Error","Gagal mengambil data kecamatan.","error")}):(N([]),f(null))},[c]),a.useEffect(()=>{S({page:o,perPage:p,search:h,sortField:b,sortDirection:m,regency_id:(c==null?void 0:c.value)||"",district_id:(d==null?void 0:d.value)||""})},[o,p,h,b,m,c,d,S]);const B=()=>{const t=JSON.stringify(s.data,null,2),i=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(i),n=document.createElement("a");n.href=r,n.download="villages.json",n.click(),URL.revokeObjectURL(r)},M=()=>{const t=y.json_to_sheet(s.data.map(r=>{var n,l,P;return{Nama:r.name_bps,Kode:r.code,Kecamatan:((n=r.district)==null?void 0:n.name_bps)||"-",Kabupaten:((P=(l=r.district)==null?void 0:l.regency)==null?void 0:P.name_bps)||"-","Code BPS":r.code_bps,"Name DAGRI":r.name_dagri,"Code DAGRI":r.code_dagri,Website:r.website||"-",Active:r.active?"Ya":"Tidak",Description:r.description||"-","Logo Path":r.logo_path||"-"}})),i=y.book_new();y.book_append_sheet(i,t,"villages"),Z(i,"villages.xlsx")},_=t=>{k(t)},q=t=>{U(t),k(1)},j=t=>{const r=["id","district_id","name_bps","code"].includes(t)?t:"id";let n="asc";r===t&&(n=m==="asc"?"desc":"asc"),J(r),$(n)},E={control:t=>({...t,borderColor:"#d1d5db",borderRadius:"0.375rem",padding:"0.25rem","&:hover":{borderColor:"#3b82f6"}}),menu:t=>({...t,zIndex:9999})},w=t=>b!==t?e.jsx(Y,{className:"ml-1"}):m==="asc"?e.jsx(Q,{className:"ml-1"}):e.jsx(X,{className:"ml-1"});return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg border border-gray-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 w-full md:w-auto",children:[e.jsx(x.div,{className:"w-full md:w-64",whileHover:{scale:1.02},transition:{type:"spring",stiffness:300},children:e.jsx(R,{options:H,value:c,onChange:t=>{G(t),f(null)},placeholder:"Pilih Kabupaten",isClearable:!0,styles:E})}),e.jsx(x.div,{className:"w-full md:w-64",whileHover:{scale:1.02},transition:{type:"spring",stiffness:300},children:e.jsx(R,{options:O,value:d,onChange:f,placeholder:"Pilih Kecamatan",isClearable:!0,isDisabled:!c,styles:E})}),e.jsx(x.input,{type:"text",placeholder:"Cari nama atau kode...",value:h,onChange:t=>A(t.target.value),className:"border p-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-500 w-full md:w-auto",whileHover:{scale:1.02},whileFocus:{scale:1.02},transition:{type:"spring",stiffness:300}})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto justify-end",children:[e.jsxs(x.button,{onClick:B,className:"bg-blue-500 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(F,{className:"mr-2"})," Export JSON"]}),e.jsxs(x.button,{onClick:M,className:"bg-green-500 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(F,{className:"mr-2"})," Export Excel"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"No"}),e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("name_bps"),children:["Nama ",w("name_bps")]}),e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("code"),children:["Kode ",w("code")]}),e.jsxs("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("district_id"),children:["Kecamatan ",w("district_id")]}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kabupaten"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):((s==null?void 0:s.data)||[]).length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"Tidak ada data"})}):((s==null?void 0:s.data)||[]).map((t,i)=>{var r,n,l;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:(o-1)*p+i+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.name_bps||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.code||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((r=t.district)==null?void 0:r.name_bps)||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((l=(n=t.district)==null?void 0:n.regency)==null?void 0:l.name_bps)||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>L(t),className:"text-blue-600 hover:text-blue-900",children:e.jsx(z,{})}),e.jsx("button",{onClick:()=>D(t),className:"text-yellow-600 hover:text-yellow-900",children:e.jsx(V,{})}),e.jsx("button",{onClick:()=>K(t.id),className:"text-red-600 hover:text-red-900",children:e.jsx(W,{})})]})})]},t.id)})})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{className:"mr-2",children:"Rows per page:"}),e.jsxs("select",{value:p,onChange:t=>q(parseInt(t.target.value)),className:"border p-1 rounded",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("button",{onClick:()=>_(o-1),disabled:o===1,className:"px-3 py-1 border rounded mr-2 disabled:opacity-50",children:"Previous"}),e.jsxs("span",{className:"mx-2",children:["Page ",o," of ",(s==null?void 0:s.last_page)||1]}),e.jsx("button",{onClick:()=>_(o+1),disabled:o===((s==null?void 0:s.last_page)||1),className:"px-3 py-1 border rounded ml-2 disabled:opacity-50",children:"Next"})]})]})]})}export{pe as default};
