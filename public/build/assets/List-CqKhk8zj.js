import{K as B,r as c,j as e}from"./app-cnLqKnWv.js";import{S}from"./sweetalert2.esm.all-LHqzTR4y.js";import{O as J,E as q,P as G,o as Q,d as V,L as W,M as X,N as Y}from"./index-sj701c6h.js";import Z from"./Actions-BBmxNL5h.js";import z from"./Procces-DtG0Kf15.js";import{m as N}from"./proxy-0toHJmZX.js";import"./iconBase-CMF4PMHw.js";import"./index-CoBPEikz.js";function ye({officials:s,fetchData:P,regencyCode:ee,loading:C,onEdit:F,onDelete:E,onView:D,onPrint:_,position:te,onAccept:T,onReject:$,role:m}){var v;B().props.auth.user;const[h,se]=c.useState(""),[u,ae]=c.useState(""),[r,w]=c.useState((s==null?void 0:s.current_page)||1),[d,f]=c.useState((s==null?void 0:s.per_page)||10),[l,M]=c.useState("id"),[i,k]=c.useState("asc"),[re,ne]=c.useState([]),[ce,de]=c.useState([]),[g,le]=c.useState(""),[j,ie]=c.useState("");c.useEffect(()=>{P({page:r,perPage:d,search:h,filters:u,sortField:l,sortDirection:i,kecamatan:g,desa:j})},[r,d,h,u,l,i,g,j]);const y=t=>w(t),A=t=>{f(Number(t.target.value)),w(1)},x=t=>{l===t?k(i==="asc"?"desc":"asc"):(M(t),k("asc"))},b=async t=>{try{const a={page:r,per_page:d,search:h,filters:u,sort_field:l,sort_direction:i,kecamatan:g,desa:j},n=await axios.get(`/regency/official/${m}/export/${t}`,{params:a,responseType:"blob"}),O={json:"json",excel:"xlsx",pdf:"pdf"},H={json:"application/json",excel:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",pdf:"application/pdf"},I=window.URL.createObjectURL(new Blob([n.data],{type:H[t]})),o=document.createElement("a");o.href=I,o.setAttribute("download",`Pejabat_${m}_${new Date().toLocaleDateString()}.${O[t]}`),document.body.appendChild(o),o.click(),o.remove(),S.fire("Success",`${t.toUpperCase()} exported successfully!`,"success")}catch(a){console.error(`Export ${t} error:`,a),S.fire("Error",`Failed to export ${t.toUpperCase()}. Please try again.`,"error")}},L=()=>b("json"),K=()=>b("excel"),R=()=>b("pdf"),p=t=>l!==t?e.jsx(W,{className:"ml-1"}):i==="asc"?e.jsx(X,{className:"ml-1"}):e.jsx(Y,{className:"ml-1"}),U=({role:t})=>{let a="",n="";switch(t){case"tolak":a="bg-red-500",n="Tolak";break;case"daftar":a="bg-blue-500",n="Daftar";break;case"validasi":a="bg-green-500",n="Terima";break;case"proses":a="bg-yellow-500",n="Proses";break;default:a="bg-gray-500",n="Tidak Diketahui"}return e.jsx("span",{className:`px-2 py-1 text-xs text-white rounded-full ${a}`,children:n})};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg border border-gray-300",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:e.jsxs("div",{className:"flex gap-2 w-full md:w-auto justify-end",children:[e.jsxs(N.button,{onClick:L,className:"bg-green-700 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(J,{className:"mr-2"})," JSON"]}),e.jsxs(N.button,{onClick:R,className:"bg-green-700 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(q,{className:"mr-2"})," PDF"]}),e.jsxs(N.button,{onClick:K,className:"bg-green-700 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(G,{className:"mr-2"})," Excel"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs border",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"70px"},children:"No"}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"250px"},onClick:()=>x("nama_lengkap"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["Nama Lengkap",p("nama_lengkap")]})}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},onClick:()=>x("nik"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["NIK",p("nik")]})}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},onClick:()=>x("nipd"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["NIPD",p("nipd")]})}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},onClick:()=>x("pendidikan"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["Pendidikan",p("pendidikan")]})}),e.jsx("th",{className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Desa"}),e.jsx("th",{className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kecamatan"}),e.jsx("th",{className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"120px"},children:"Proses"}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"120px"},children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-2 py-4 border text-center",children:"Memuat data..."})}):((v=s==null?void 0:s.data)==null?void 0:v.length)>0?s.data.map((t,a)=>{var n;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:(r-1)*d+a+1}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.nama_lengkap}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.nik}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.nipd}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:((n=t==null?void 0:t.identities)==null?void 0:n.pendidikan_terakhir)||"-"}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.village.name_dagri||"-"}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.village.district.name_dagri||"-"}),e.jsx("td",{className:"border px-2 py-2 whitespace-nowrap text-sm text-gray-500 text-center",children:e.jsx(U,{role:t.status})}),e.jsx("td",{className:"border px-2 py-2 whitespace-nowrap text-sm text-gray-500 text-center",children:e.jsx(z,{row:t,onAccept:T,onReject:$})}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:e.jsx(Z,{row:t,onEdit:F,onDelete:E,onView:D,onPrint:_,role:m})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"Tidak ada data yang ditemukan"})})})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4",children:[e.jsxs("div",{className:"mb-2 md:mb-0 flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("select",{id:"rowsPerPage",value:d,onChange:A,className:"border rounded",children:[5,10,25,50,100].map(t=>e.jsx("option",{value:t,children:t},t))})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:(r-1)*d+1})," ","-"," ",e.jsx("span",{className:"font-medium",children:Math.min(r*d,(s==null?void 0:s.total)||0)})," ","Total"," ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.total)||0})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>y(r-1),disabled:r===1,className:"px-3 py-1 border rounded disabled:opacity-50 bg-green-700 text-white",children:e.jsx(Q,{})}),Array.from({length:Math.ceil(((s==null?void 0:s.total)||0)/d)},(t,a)=>a+1).slice(Math.max(0,r-3),Math.min(Math.ceil(((s==null?void 0:s.total)||0)/d),r+2)).map(t=>e.jsx("button",{onClick:()=>y(t),className:`px-3 py-1 border rounded ${r===t?"bg-green-700 text-white opacity-50":""}`,children:t},t)),e.jsx("button",{onClick:()=>y(r+1),disabled:r===Math.ceil(((s==null?void 0:s.total)||0)/d),className:"px-3 py-1 border rounded disabled:opacity-50 bg-green-700 text-white",children:e.jsx(V,{})})]})})]})]})}export{ye as default};
