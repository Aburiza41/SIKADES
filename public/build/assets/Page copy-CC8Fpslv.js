import{K as Na,r as u,j as e,L as Sa,S as v}from"./app-cnLqKnWv.js";import{S as l}from"./sweetalert2.esm.all-LHqzTR4y.js";import{A as Ca}from"./AuthenticatedLayout-DtE7q2g1.js";import Da from"./List-CqKhk8zj.js";import{m as Pa}from"./index-CyDsHmf4.js";import Ba from"./Modal-Dkqcwd-b.js";import $a from"./PDF-BjBvblQi.js";import{n as Ta,a as N,b as Fa,c as Aa,d as Ea,e as La,f as da,g as Ia,o as Ka,F as Ma,h as Va,i as Ra}from"./index-CoBPEikz.js";import{m as p}from"./proxy-0toHJmZX.js";import{A as Ha}from"./index-CSb7vC3W.js";import"./index-sj701c6h.js";import"./iconBase-CMF4PMHw.js";import"./transition-LX_87-cn.js";import"./LoadingPage-CsjTuYab.js";import"./Actions-BBmxNL5h.js";import"./Procces-DtG0Kf15.js";import"./jspdf.plugin.autotable-Cut1Q0GP.js";import"./typeof-QjJsDpFa.js";var ma;const Ja=((ma=document.querySelector('meta[name="csrf-token"]'))==null?void 0:ma.getAttribute("content"))||"";function ue({initialOfficials:x,officials:h,role:i,position:m,regency_code:j}){var T,F,A,E,L,I,K,M,V,R,H,J,U,z,W,Y,q,X,G,Q,Z,f,O,aa,ea,ta,na,sa,ra,ia,oa,la;const{flash:c}=Na().props,[_,y]=u.useState(x),[ua,w]=u.useState(!1),[pa,S]=u.useState(!1),[za,C]=u.useState(!1),[ca,D]=u.useState(!1),[a,P]=u.useState(null),[Wa,k]=u.useState(!1),[Ya,ga]=u.useState({village_id:"",nik:"",niad:"",nama_lengkap:"",gelar_depan:"",gelar_belakang:"",tempat_lahir:"",tanggal_lahir:"",jenis_kelamin:"",status_perkawinan:"",agama:"",alamat:"",rt:"",rw:"",regency_code:"",regency_name:"",district_code:"",district_name:"",village_code:"",village_name:"",handphone:"",gol_darah:"",pendidikan:"",bpjs_kesehatan:"",bpjs_ketenagakerjaan:"",npwp:"",status:""});u.useEffect(()=>{c!=null&&c.success&&l.fire("Success",c.success,"success"),c!=null&&c.error&&l.fire("Error",c.error,"error")},[c]);const B=({page:t=1,perPage:s=10,search:r="",filters:o="",sortField:d="",sortDirection:g="",kecamatan:va,desa:ya})=>{w(!0),v.get(`/regency/official/${i}`,{page:t,per_page:s,search:r,filters:o,sort_field:d,sort_direction:g,kecamatan:va,desa:ya},{preserveState:!0,replace:!0,onSuccess:wa=>{y(wa.props.officials),w(!1)},onError:()=>{l.fire("Error","Failed to fetch data. Please try again.","error"),w(!1)}})},xa=(t,s)=>{window.location.href=`/village/official/${s}/${t.nik}/edit`},ha=t=>{P(t),C(!1),D(!0),S(!0)},ja=(t,s)=>{l.fire({title:"Are you sure?",text:"This data will be deleted!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&v.delete(`/village/official/${s}/${t.nik}/delete`,{headers:{"X-CSRF-TOKEN":Ja},onSuccess:()=>{l.fire("Deleted!","Data has been successfully deleted.","success"),B({})},onError:()=>{l.fire("Error","An error occurred while deleting the data.","error")}})})},ka=t=>{const s={nama_lengkap:t.nama_lengkap,nik:t.nik,niad:t.niad,tempat_lahir:t.tempat_lahir,tanggal_lahir:t.tanggal_lahir,jenis_kelamin:t.jenis_kelamin,status_perkawinan:t.status_perkawinan,agama:t.agama,alamat:t.alamat,handphone:t.handphone,gol_darah:t.gol_darah,pendidikan:t.pendidikan,bpjs_kesehatan:t.bpjs_kesehatan,bpjs_ketenagakerjaan:t.bpjs_ketenagakerjaan,npwp:t.npwp,status:t.status};$a(s)},$=()=>{S(!1),C(!1),D(!1),P(null),ga({village_id:"",nik:"",niad:"",nama_lengkap:"",gelar_depan:"",gelar_belakang:"",tempat_lahir:"",tanggal_lahir:"",jenis_kelamin:"",status_perkawinan:"",agama:"",alamat:"",rt:"",rw:"",regency_code:"",regency_name:"",district_code:"",district_name:"",village_code:"",village_name:"",handphone:"",gol_darah:"",pendidikan:"",bpjs_kesehatan:"",bpjs_ketenagakerjaan:"",npwp:"",status:""})},ba=t=>{l.fire({title:"Apakah anda yakin?",text:`Pilih terima untuk menyetujui verifikasi ${t.nama_lengkap}`,icon:"question",input:"textarea",inputLabel:"Catatan",inputPlaceholder:"Masukkan catatan untuk verifikasi...",inputAttributes:{"aria-label":"Catatan untuk verifikasi"},showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",confirmButtonText:"Terima",cancelButtonText:"Batal",preConfirm:s=>({notes:s})}).then(s=>{s.isConfirmed&&(k(!0),v.post(`/regency/official/${i}/status/${t.nik}/accept`,{notes:s.value.notes},{onSuccess:r=>{const o=r.data;l.fire({toast:!0,position:"top-end",icon:"success",title:`Verifikasi ${o.nama_lengkap} diterima`,text:o.notes||"Tidak ada catatan",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{container:"swal2-toast-container"}});const d=_.data.map(g=>g.nik===t.nik?{...g,status:"validasi"}:g);y({..._,data:d}),k(!1),Inertia.reload({preserveState:!0,preserveScroll:!0})},onError:r=>{var o,d;l.fire({toast:!0,position:"top-end",icon:"error",title:"Error",text:((d=(o=r.response)==null?void 0:o.data)==null?void 0:d.message)||`Verifikasi Terima ${t.nama_lengkap} dalam kendala`,showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{container:"swal2-toast-container"}}),k(!1)}}))})},_a=t=>{l.fire({title:"Apakah anda yakin?",text:`Pilih tolak untuk menolak verifikasi ${t.nama_lengkap}`,icon:"warning",input:"textarea",inputLabel:"Catatan",inputPlaceholder:"Masukkan catatan untuk penolakan...",inputAttributes:{"aria-label":"Catatan untuk penolakan"},showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:"Tolak",cancelButtonText:"Batal",preConfirm:s=>({notes:s})}).then(s=>{s.isConfirmed&&(k(!0),v.post(`/regency/official/${i}/status/${t.nik}/reject`,{notes:s.value.notes},{onSuccess:r=>{const o=r.data||{nama_lengkap:t.nama_lengkap,notes:s.value.notes};l.fire({toast:!0,position:"top-end",icon:"success",title:`Verifikasi ${o.nama_lengkap} ditolak`,text:o.notes||"Tidak ada catatan",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{container:"swal2-toast-container"}});const d=_.data.map(g=>g.nik===t.nik?{...g,status:"tolak"}:g);y({..._,data:d}),k(!1),Inertia.reload({preserveState:!0,preserveScroll:!0})},onError:r=>{var o,d;l.fire({toast:!0,position:"top-end",icon:"error",title:"Error",text:((d=(o=r.response)==null?void 0:o.data)==null?void 0:d.message)||`Verifikasi Tolak ${t.nama_lengkap} dalam kendala`,showConfirmButton:!1,timer:3e3,timerProgressBar:!0,customClass:{container:"swal2-toast-container"}}),k(!1)}}))})};return e.jsxs(Ca,{header:e.jsxs("div",{className:"text-2xl font-semibold leading-tight",children:["Daftar ",m.name,e.jsxs("p",{className:"text-sm font-thin mt-1",children:["Daftar pejabat desa dengan jabatan ",m.name]})]}),breadcrumb:[{name:"Pejabat",path:`/admin/official/${i}`,active:!0,icon:e.jsx(Pa,{className:"w-5 h-5 mr-3"})}],children:[e.jsx(Sa,{title:"Official"}),e.jsx("div",{className:"p-4",children:e.jsx(Da,{officials:_,fetchData:B,loading:ua,onEdit:xa,onDelete:ja,onView:ha,onPrint:ka,position:m,onAccept:ba,onReject:_a,regencyCode:j,role:i})}),e.jsx(Ba,{isOpen:pa&&ca,onClose:$,title:"Detail Pejabat Desa",children:e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"space-y-4 overflow-y-auto max-h-[90vh]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-xl",children:[(T=a==null?void 0:a.identities)!=null&&T.foto?e.jsxs(p.div,{whileHover:{scale:1.03},className:"relative group cursor-pointer",children:[e.jsx("img",{src:`/private-images/${(F=a==null?void 0:a.identities)==null?void 0:F.foto}`,alt:`Foto ${a.nama_lengkap}`,className:"w-32 h-32 rounded-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Ta,{className:"text-white text-2xl"})})]}):e.jsx("div",{className:"w-32 h-32 md:w-40 md:h-40 rounded-full bg-gray-200 flex items-center justify-center text-gray-400",children:e.jsx(N,{className:"text-5xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs(p.h2,{className:"text-2xl font-bold text-gray-800 mb-1",initial:{x:-10,opacity:0},animate:{x:0,opacity:1},transition:{delay:.1},children:[(a==null?void 0:a.gelar_depan)&&`${a.gelar_depan} `,a==null?void 0:a.nama_lengkap,(a==null?void 0:a.gelar_belakang)&&`, ${a.gelar_belakang}`]}),e.jsx(p.p,{className:"text-lg text-blue-600 font-medium mb-3",initial:{x:-10,opacity:0},animate:{x:0,opacity:1},transition:{delay:.15},children:(E=(A=a==null?void 0:a.position_current)==null?void 0:A.position)==null?void 0:E.name}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(p.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm flex items-center gap-1",children:[e.jsx(N,{size:14})," ",(a==null?void 0:a.jenis_kelamin)==="L"?"Laki-laki":"Perempuan"]}),e.jsxs(p.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.25},className:"px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm flex items-center gap-1",children:[e.jsx(Fa,{size:14})," ",a==null?void 0:a.tanggal_lahir," (",Ua(a==null?void 0:a.tanggal_lahir)," ","tahun)"]}),e.jsxs(p.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},className:"px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm flex items-center gap-1",children:[e.jsx(Aa,{size:14})," Gol. Darah:"," ",((L=a==null?void 0:a.identities)==null?void 0:L.gol_darah)||"-"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(b,{title:"Informasi Pribadi",icon:e.jsx(N,{className:"text-blue-500"}),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:[e.jsx(n,{label:"NIK",value:a==null?void 0:a.nik}),e.jsx(n,{label:"NIPD",value:a==null?void 0:a.nipd}),e.jsx(n,{label:"Tempat Lahir",value:a==null?void 0:a.tempat_lahir}),e.jsx(n,{label:"Tanggal Lahir",value:a==null?void 0:a.tanggal_lahir}),e.jsx(n,{label:"Agama",value:a==null?void 0:a.agama}),e.jsx(n,{label:"Status Perkawinan",value:a==null?void 0:a.status_perkawinan}),e.jsx(n,{label:"Pendidikan Terakhir",value:(I=a==null?void 0:a.identities)==null?void 0:I.pendidikan_terakhir})]})}),e.jsx(b,{title:"Alamat",icon:e.jsx(Ea,{className:"text-green-500"}),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:[e.jsx(n,{label:"Alamat",value:(K=a==null?void 0:a.addresses)==null?void 0:K.alamat,fullWidth:!0}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(n,{label:"RT",value:(M=a==null?void 0:a.addresses)==null?void 0:M.rt}),e.jsx(n,{label:"RW",value:(V=a==null?void 0:a.addresses)==null?void 0:V.rw})]}),e.jsx(n,{label:"Desa/Kelurahan",value:`${(R=a==null?void 0:a.addresses)==null?void 0:R.village_name} (${(H=a==null?void 0:a.village)==null?void 0:H.name_dagri})`}),e.jsx(n,{label:"Kecamatan",value:`${(J=a==null?void 0:a.addresses)==null?void 0:J.district_name} (${(z=(U=a==null?void 0:a.village)==null?void 0:U.district)==null?void 0:z.name_dagri})`}),e.jsx(n,{label:"Kabupaten/Kota",value:`${(W=a==null?void 0:a.addresses)==null?void 0:W.regency_name} (${(X=(q=(Y=a==null?void 0:a.village)==null?void 0:Y.district)==null?void 0:q.regency)==null?void 0:X.name_dagri})`}),e.jsx(n,{label:"Provinsi",value:(G=a==null?void 0:a.addresses)==null?void 0:G.province_name})]})}),e.jsx(b,{title:"Kontak",icon:e.jsx(La,{className:"text-purple-500"}),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 p-4",children:[e.jsx(n,{label:"Nomor Handphone",value:(Q=a==null?void 0:a.contacts)==null?void 0:Q.handphone}),e.jsx(n,{label:"Email",value:((Z=a==null?void 0:a.contacts)==null?void 0:Z.email)||"-"})]})}),e.jsx(b,{title:"Dokumen Identitas",icon:e.jsx(da,{className:"text-yellow-500"}),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:[e.jsx(n,{label:"BPJS Kesehatan",value:((f=a==null?void 0:a.identities)==null?void 0:f.bpjs_kesehatan)||"-"}),e.jsx(n,{label:"BPJS Ketenagakerjaan",value:((O=a==null?void 0:a.identities)==null?void 0:O.bpjs_ketenagakerjaan)||"-"}),e.jsx(n,{label:"NPWP",value:((aa=a==null?void 0:a.identities)==null?void 0:aa.npwp)||"-"})]})}),e.jsx(b,{title:"Posisi & Jabatan",icon:e.jsx(Ia,{className:"text-red-500"}),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:[e.jsx(n,{label:"Jabatan",value:(ta=(ea=a==null?void 0:a.position_current)==null?void 0:ea.position)==null?void 0:ta.name}),e.jsx(n,{label:"Penetap",value:(na=a==null?void 0:a.position_current)==null?void 0:na.penetap}),e.jsx(n,{label:"Nomor SK",value:(sa=a==null?void 0:a.position_current)==null?void 0:sa.nomor_sk}),e.jsx(n,{label:"Tanggal SK",value:(ra=a==null?void 0:a.position_current)==null?void 0:ra.tanggal_sk}),e.jsx(n,{label:"TMT Jabatan",value:(ia=a==null?void 0:a.position_current)==null?void 0:ia.tmt_jabatan}),((oa=a==null?void 0:a.position_current)==null?void 0:oa.file_sk)&&e.jsxs("div",{className:"md:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"File SK"}),e.jsxs("a",{href:a.position_current.file_sk,target:"_blank",rel:"noopener noreferrer",className:"mt-1 inline-flex items-center text-blue-600 hover:underline",children:[e.jsx(da,{className:"mr-1"})," ","Lihat Dokumen SK"]})]})]})}),e.jsx(b,{title:"History Status Log",icon:e.jsx(Ka,{className:"text-green-500"}),children:(la=a==null?void 0:a.status_logs)!=null&&la.length?e.jsx("div",{className:"p-4 space-y-6",children:a.status_logs.map((t,s)=>{var r;return e.jsxs("div",{className:"border rounded-lg shadow-sm p-4 bg-white",children:[e.jsxs("h4",{className:"font-semibold text-gray-700 mb-3",children:["#",s+1," â€“"," ",(r=t.status_baru)==null?void 0:r.toUpperCase()]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2 text-sm",children:[e.jsx(n,{label:"ID Log",value:t.id}),e.jsx(n,{label:"Status Sebelumnya",value:t.status_sebelumnya??"-"}),e.jsx(n,{label:"Status Baru",value:t.status_baru}),e.jsx(n,{label:"User ID",value:t.user_id}),e.jsx(n,{label:"Dibuat",value:new Date(t.created_at).toLocaleString()}),e.jsx(n,{label:"Diubah",value:new Date(t.updated_at).toLocaleString()}),t.keterangan&&e.jsx("div",{className:"md:col-span-2 lg:col-span-3",children:e.jsx(n,{label:"Keterangan",value:t.keterangan})})]})]},t.id)})}):e.jsx("p",{className:"p-4 text-gray-500 italic",children:"Belum ada history perubahan status."})})]}),e.jsx("div",{className:"flex justify-end pt-4 p-4",children:e.jsxs(p.button,{whileHover:{scale:1.05,boxShadow:"0px 2px 8px rgba(0,0,0,0.1)"},whileTap:{scale:.98},onClick:$,className:"px-6 py-2 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-lg hover:from-blue-600 hover:to-indigo-700 flex items-center gap-2 shadow-md",children:[e.jsx(Ma,{size:18})," Tutup"]})})]})})]})}const b=({title:x,icon:h,children:i})=>{const[m,j]=u.useState(!0);return e.jsxs(p.div,{className:"bg-white rounded-xl overflow-hidden border border-gray-100 shadow",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:[e.jsxs("button",{onClick:()=>j(!m),className:"w-full flex justify-between items-center p-4 hover:bg-gray-100 bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"text-lg",children:h}),e.jsx("h3",{className:"text-lg font-medium text-gray-800",children:x})]}),m?e.jsx(Va,{}):e.jsx(Ra,{})]}),e.jsx(Ha,{children:m&&e.jsx(p.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:i})})]})},n=({label:x,value:h,fullWidth:i=!1})=>e.jsxs("div",{className:i?"md:col-span-2 lg:col-span-3":"",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-500",children:x}),e.jsx("p",{className:"mt-1 text-gray-900 font-medium",children:h||"-"})]}),Ua=x=>{if(!x)return"-";const h=new Date,i=new Date(x);let m=h.getFullYear()-i.getFullYear();const j=h.getMonth()-i.getMonth();return(j<0||j===0&&h.getDate()<i.getDate())&&m--,m};export{ue as default};
