import{K,r as s,S as g,j as e,L as R}from"./app-cnLqKnWv.js";import{S as a}from"./sweetalert2.esm.all-LHqzTR4y.js";import{A as $}from"./AuthenticatedLayout-DtE7q2g1.js";import q from"./List-BhbeCcyz.js";import{a as H,m as J}from"./index-CyDsHmf4.js";import y from"./Modal-Ec3Xpf7S.js";import"./index-sj701c6h.js";import"./iconBase-CMF4PMHw.js";import"./transition-LX_87-cn.js";import"./LoadingPage-CsjTuYab.js";import"./proxy-0toHJmZX.js";import"./index-CSb7vC3W.js";import"./index.es-Q68aKp3t.js";import"./xlsx-5rFX-EW9.js";import"./Actions-BRsG-T7r.js";import"./index-CoBPEikz.js";var v;const N=((v=document.querySelector('meta[name="csrf-token"]'))==null?void 0:v.getAttribute("content"))||"";function ce({organizations:k,sort:w,search:O}){const{flash:r}=K().props,[C,E]=s.useState(k),[D,x]=s.useState(!1),[b,z]=s.useState(w||{}),[T,B]=s.useState(O||""),[j,l]=s.useState(!1),[c,u]=s.useState(!1),[S,m]=s.useState(!1),[i,p]=s.useState(null),[o,d]=s.useState({title:"",description:""});s.useEffect(()=>{r!=null&&r.success&&a.fire("Success",r.success,"success"),r!=null&&r.error&&a.fire("Error",r.error,"error")},[r]);const f=s.useCallback((t={})=>{x(!0),g.get("/admin/organization",{page:t.page||1,per_page:t.perPage||10,search:t.search||T,sort_field:t.sortField||b.sort_field,sort_direction:t.sortDirection||b.sort_direction},{preserveState:!0,replace:!0,onSuccess:n=>{E(n.props.organizations),z(n.props.sort||{}),B(n.props.search||""),x(!1)},onError:()=>{a.fire("Error","Failed to fetch data. Please try again.","error"),x(!1)}})},[]),A=()=>{u(!1),m(!1),l(!0),p(null),d({title:"",description:""})},L=t=>{p(t),u(!0),m(!1),l(!0),d({title:t.title||"",description:t.description||""})},M=t=>{p(t),u(!1),m(!0),l(!0)},_=t=>{a.fire({title:"Apakah Anda yakin?",text:"Data ini akan dihapus permanen!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&g.delete(`/admin/organization/${t}`,{headers:{"X-CSRF-TOKEN":N},onSuccess:()=>{a.fire("Terhapus!","Data berhasil dihapus.","success"),f({})},onError:()=>{a.fire("Error","Terjadi kesalahan saat menghapus data.","error")}})})},F=t=>{t.preventDefault();const n=c?`/admin/organization/${i.id}`:"/admin/organization",P=c?"put":"post",V={title:o.title,description:o.description};g[P](n,V,{headers:{"X-CSRF-TOKEN":N},onSuccess:()=>{a.fire("Success",`Organisasi ${c?"diperbarui":"ditambahkan"} berhasil.`,"success"),l(!1),f({})},onError:I=>{a.fire("Error",Object.values(I).join(", "),"error")}})},h=()=>{l(!1),u(!1),m(!1),p(null),d({title:"",description:""})};return e.jsxs($,{header:e.jsxs("div",{className:"text-2xl font-semibold leading-tight",children:["Organization",e.jsx("p",{className:"text-sm font-thin mt-1",children:"Daftar Organisasi"})]}),breadcrumb:[{name:"Organization",path:"/admin/organization",active:!0,icon:e.jsx(J,{className:"w-5 h-5 mr-3"})}],children:[e.jsx(R,{title:"Organization"}),e.jsxs("div",{className:"p-4",children:[e.jsxs("button",{onClick:A,className:"mb-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center",children:[e.jsx(H,{className:"mr-2"}),"Tambah Organisasi"]}),e.jsx(q,{organizations:C,fetchData:f,loading:D,onEdit:L,onDelete:_,onView:M})]}),e.jsx(y,{isOpen:j&&!S,onClose:h,title:c?"Edit Organisasi":"Tambah Organisasi",children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Judul"}),e.jsx("input",{type:"text",value:o.title,onChange:t=>d({...o,title:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deskripsi"}),e.jsx("textarea",{value:o.description,onChange:t=>d({...o,description:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm",rows:"3"})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:h,className:"mr-2 px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:c?"Perbarui":"Simpan"})]})]})})}),e.jsx(y,{isOpen:j&&S,onClose:h,title:"Lihat Organisasi",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Judul"}),e.jsx("p",{className:"mt-1 text-gray-900",children:i==null?void 0:i.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deskripsi"}),e.jsx("p",{className:"mt-1 text-gray-900",children:(i==null?void 0:i.description)||"-"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Tutup"})})]})})]})}export{ce as default};
