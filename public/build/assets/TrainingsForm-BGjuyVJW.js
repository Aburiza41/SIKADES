import{r as s,j as e,a as Y}from"./app-cnLqKnWv.js";import{a as M,b as $,c as q}from"./index-CyDsHmf4.js";import{S as L}from"./react-select.esm-kjDh-dq3.js";import{S as n}from"./sweetalert2.esm.all-LHqzTR4y.js";import{m as l}from"./proxy-0toHJmZX.js";import{A as O}from"./index-CSb7vC3W.js";import"./iconBase-CMF4PMHw.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";function ne({trainings:B=[],setTrainings:_=()=>{},officialTrainings:i=[],setOfficialTrainings:h=()=>{}}){const[H,w]=s.useState(!1),[E,v]=s.useState(!1),[g,k]=s.useState(""),[S,C]=s.useState(""),[r,o]=s.useState(null),[y,c]=s.useState(""),[b,d]=s.useState(""),[T,m]=s.useState(""),[G,x]=s.useState(null),[P,u]=s.useState(""),[p,f]=s.useState(null),J=B.map(a=>({value:a.id,label:a.title})),R=()=>w(!0),j=()=>{w(!1),k(""),C("")},D=(a=null)=>{if(a!==null){const t=i[a];o({value:t.training_id,label:t.training_title}),c(t.nama),d(t.mulai),m(t.selesai||""),x(t.doc_scan||null),u(t.keterangan||""),f(a)}else o(null),c(""),d(""),m(""),x(null),u(""),f(null);v(!0)},A=()=>{v(!1),o(null),c(""),d(""),m(""),x(null),u(""),f(null)},I=async()=>{if(!g.trim()){n.fire({icon:"error",title:"Oops...",text:"Judul pelatihan tidak boleh kosong!"});return}try{const a=await Y.post("/village/official/training/store",{title:g,description:S});if(a.data.success){const t={id:a.data.data.id,title:a.data.data.title,description:a.data.data.description};_(N=>[...N,t]),j()}else n.fire({icon:"error",title:"Gagal",text:"Gagal menambahkan pelatihan baru: "+a.data.message})}catch(a){console.error("Gagal menambahkan pelatihan baru:",a),n.fire({icon:"error",title:"Gagal",text:"Terjadi kesalahan saat menambahkan pelatihan baru. Silakan coba lagi."}),j()}},K=()=>{if(!r||!y||!b){n.fire({icon:"error",title:"Oops...",text:"Harap isi semua field yang diperlukan!"});return}const a={training_id:r.value,training_title:r.label,nama:y,mulai:b,selesai:T,doc_scan:G,keterangan:P};if(p!==null){const t=[...i];t[p]=a,h(t)}else h([...i,a]);A()},F=a=>{n.fire({title:"Apakah Anda yakin?",text:"Data yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(t=>{if(t.isConfirmed){const N=i.filter((Q,z)=>z!==a);h(N),n.fire("Dihapus!","Data telah dihapus.","success")}})};return e.jsxs(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"bg-white w-full p-6 shadow rounded-lg mt-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 pb-4 border-b",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:"G. Formulir Riwayat Pelatihan"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Formulir ini digunakan untuk mengisi riwayat pelatihan pejabat desa."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(l.button,{type:"button",onClick:R,whileHover:{scale:1.03},whileTap:{scale:.98},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center text-sm",children:[e.jsx(M,{className:"mr-2"})," Jenis Pelatihan"]}),e.jsxs(l.button,{type:"button",onClick:()=>D(),whileHover:{scale:1.03},whileTap:{scale:.98},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center text-sm",children:[e.jsx(M,{className:"mr-2"})," Tambah Riwayat"]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pelatihan"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mulai"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Selesai"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keterangan"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.length>0?i.map((a,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:a.training_title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:a.nama}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:a.mulai}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:a.selesai||"-"}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-800 max-w-xs truncate",children:a.keterangan||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",onClick:()=>D(t),className:"px-3 py-1 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 flex items-center text-xs",children:[e.jsx($,{className:"mr-1"})," Edit"]}),e.jsxs("button",{type:"button",onClick:()=>F(t),className:"px-3 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center text-xs",children:[e.jsx(q,{className:"mr-1"})," Hapus"]})]})})]},t)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"Tidak ada data riwayat pelatihan."})})})]})})]}),e.jsx(O,{children:H&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx(l.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Tambah Jenis Pelatihan Baru"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Judul Pelatihan"}),e.jsx("input",{type:"text",value:g,onChange:a=>k(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Judul Pelatihan"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),e.jsx("textarea",{value:S,onChange:a=>C(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Deskripsi Pelatihan",rows:"3"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:j,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Batal"}),e.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Simpan"})]})]})})})}),e.jsx(O,{children:E&&e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx(l.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:p!==null?"Edit Riwayat Pelatihan":"Tambah Riwayat Pelatihan"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pelatihan"}),e.jsx(L,{options:J,value:r,onChange:o,placeholder:"Pilih Pelatihan",isClearable:!0,isSearchable:!0,className:"basic-single",classNamePrefix:"select"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama"}),e.jsx("input",{type:"text",value:y,onChange:a=>c(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nama"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mulai"}),e.jsx("input",{type:"date",value:b,onChange:a=>d(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Selesai"}),e.jsx("input",{type:"date",value:T,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dokumen"}),e.jsx("input",{type:"file",onChange:a=>x(a.target.files[0]),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keterangan"}),e.jsx("textarea",{value:P,onChange:a=>u(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Keterangan",rows:"3"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Batal"}),e.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:p!==null?"Simpan Perubahan":"Simpan"})]})]})})})})]})}export{ne as default};
