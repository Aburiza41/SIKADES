import{K as H,r as i,j as e,L as X,S as N}from"./app-cnLqKnWv.js";import{S as c}from"./sweetalert2.esm.all-LHqzTR4y.js";import{A as Y}from"./AuthenticatedLayout-DtE7q2g1.js";import q from"./List-BULA84zu.js";import{k as U}from"./index-CyDsHmf4.js";import C from"./Modal-DBHYtVJw.js";import"./index-sj701c6h.js";import"./iconBase-CMF4PMHw.js";import"./transition-LX_87-cn.js";import"./LoadingPage-CsjTuYab.js";import"./proxy-0toHJmZX.js";import"./index-CSb7vC3W.js";import"./xlsx-5rFX-EW9.js";import"./react-select.esm-kjDh-dq3.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";var K;const E=((K=document.querySelector('meta[name="csrf-token"]'))==null?void 0:K.getAttribute("content"))||"";function be({initialDistricts:A,regencies:v}){var S;const{flash:n}=H().props,[B,R]=i.useState(A),[T,j]=i.useState(!1),[k,l]=i.useState(!1),[m,u]=i.useState(!1),[w,p]=i.useState(!1),[t,f]=i.useState(null),[I,$]=i.useState(null),[s,d]=i.useState({regency_id:"",code_bps:"",name_bps:"",code_dagri:"",name_dagri:"",active:!1,code:""}),[r,o]=i.useState({});i.useEffect(()=>{n!=null&&n.success&&c.fire("Success",n.success,"success"),n!=null&&n.error&&c.fire("Error",n.error,"error")},[n]);const _=({page:a=1,perPage:x=10,search:b="",sortField:y="",sortDirection:g="",regency_id:V=""})=>{j(!0),N.get("/admin/district",{page:a,per_page:x,search:b,sort_field:y,sort_direction:g,regency_id:V},{preserveState:!0,replace:!0,onSuccess:F=>{R(F.props.initialDistricts),j(!1)},onError:()=>{c.fire("Error","Gagal mengambil data. Silakan coba lagi.","error"),j(!1)}})},D=()=>{u(!1),p(!1),l(!0),o({}),d({regency_id:"",code_bps:"",name_bps:"",code_dagri:"",name_dagri:"",active:!1,code:""})},O=a=>{f(a),u(!0),p(!1),l(!0),o({}),d({regency_id:a.regency_id,code_bps:a.code_bps,name_bps:a.name_bps,code_dagri:a.code_dagri,name_dagri:a.name_dagri,active:a.active,code:a.code})},P=a=>{f(a),u(!1),p(!0),l(!0)},G=a=>{c.fire({title:"Apakah Anda yakin?",text:"Data kecamatan ini akan dihapus!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(x=>{x.isConfirmed&&N.delete(`/admin/district/${a}`,{headers:{"X-CSRF-TOKEN":E},onSuccess:()=>{c.fire("Terhapus!","Kecamatan berhasil dihapus.","success"),_({})},onError:b=>{c.fire("Error",b.error||"Terjadi kesalahan saat menghapus data.","error")}})})},M=()=>{const a={};return s.regency_id||(a.regency_id="Kabupaten wajib dipilih."),s.code_bps||(a.code_bps="Code BPS wajib diisi."),s.name_bps||(a.name_bps="Name BPS wajib diisi."),s.code_dagri||(a.code_dagri="Code DAGRI wajib diisi."),s.name_dagri||(a.name_dagri="Name DAGRI wajib diisi."),s.code||(a.code="Code wajib diisi."),o(a),Object.keys(a).length===0},L=a=>{if(a.preventDefault(),!M()){c.fire("Error","Harap isi semua kolom yang wajib.","error");return}const x=m?`/admin/district/${t.id}`:"/admin/district",b=m?"put":"post",y={regency_id:s.regency_id,code_bps:s.code_bps,name_bps:s.name_bps,code_dagri:s.code_dagri,name_dagri:s.name_dagri,active:s.active,code:s.code};N[b](x,y,{headers:{"X-CSRF-TOKEN":E},onSuccess:()=>{c.fire("Success",`Kecamatan ${m?"diperbarui":"ditambahkan"} berhasil.`,"success"),l(!1),o({}),_({})},onError:g=>{o(g),c.fire("Error",Object.values(g).join(", "),"error")}})},h=()=>{l(!1),u(!1),p(!1),f(null),o({}),d({regency_id:"",code_bps:"",name_bps:"",code_dagri:"",name_dagri:"",active:!1,code:""})};return e.jsxs(Y,{header:e.jsxs("div",{className:"text-2xl font-semibold leading-tight",children:["Kecamatan",e.jsx("p",{className:"text-sm font-thin mt-1",children:"Daftar Kecamatan"})]}),breadcrumb:[{name:"Kecamatan",path:"/admin/district",active:!0,icon:e.jsx(U,{className:"w-5 h-5 mr-3"})}],children:[e.jsx(X,{title:"Kecamatan"}),e.jsxs("div",{className:"p-4",children:[e.jsx("button",{onClick:D,className:"mb-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Tambah Kecamatan"}),e.jsx(q,{districts:B,fetchData:_,loading:T,onEdit:O,onDelete:G,onView:P,regencies:v,selectedRegency:I,setSelectedRegency:$})]}),e.jsx(C,{isOpen:k&&!w,onClose:h,title:m?"Ubah Kecamatan":"Tambah Kecamatan",children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kabupaten"}),e.jsxs("select",{value:s.regency_id,onChange:a=>d({...s,regency_id:a.target.value}),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${r.regency_id?"border-red-500":""}`,children:[e.jsx("option",{value:"",children:"Pilih Kabupaten"}),v.map(a=>e.jsx("option",{value:a.id,children:a.name_bps},a.id))]}),r.regency_id&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.regency_id})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Code BPS"}),e.jsx("input",{type:"text",value:s.code_bps,onChange:a=>d({...s,code_bps:a.target.value}),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${r.code_bps?"border-red-500":""}`}),r.code_bps&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.code_bps})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name BPS"}),e.jsx("input",{type:"text",value:s.name_bps,onChange:a=>d({...s,name_bps:a.target.value}),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${r.name_bps?"border-red-500":""}`}),r.name_bps&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.name_bps})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Code DAGRI"}),e.jsx("input",{type:"text",value:s.code_dagri,onChange:a=>d({...s,code_dagri:a.target.value}),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${r.code_dagri?"border-red-500":""}`}),r.code_dagri&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.code_dagri})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name DAGRI"}),e.jsx("input",{type:"text",value:s.name_dagri,onChange:a=>d({...s,name_dagri:a.target.value}),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${r.name_dagri?"border-red-500":""}`}),r.name_dagri&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.name_dagri})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Active"}),e.jsx("input",{type:"checkbox",checked:s.active,onChange:a=>d({...s,active:a.target.checked}),className:"mt-1 rounded border-gray-300"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Code"}),e.jsx("input",{type:"text",value:s.code,onChange:a=>d({...s,code:a.target.value}),className:`mt-1 block w-full rounded-md border-gray-300 shadow-sm ${r.code?"border-red-500":""}`}),r.code&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:r.code})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:h,className:"mr-2 px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:m?"Perbarui":"Simpan"})]})]})})}),e.jsx(C,{isOpen:k&&w,onClose:h,title:"Lihat Kecamatan",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kabupaten"}),e.jsx("p",{className:"mt-1 text-gray-900",children:(S=t==null?void 0:t.regency)==null?void 0:S.name_bps})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Code BPS"}),e.jsx("p",{className:"mt-1 text-gray-900",children:t==null?void 0:t.code_bps})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name BPS"}),e.jsx("p",{className:"mt-1 text-gray-900",children:t==null?void 0:t.name_bps})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Code DAGRI"}),e.jsx("p",{className:"mt-1 text-gray-900",children:t==null?void 0:t.code_dagri})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name DAGRI"}),e.jsx("p",{className:"mt-1 text-gray-900",children:t==null?void 0:t.name_dagri})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Active"}),e.jsx("p",{className:"mt-1 text-gray-900",children:t!=null&&t.active?"Ya":"Tidak"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Code"}),e.jsx("p",{className:"mt-1 text-gray-900",children:t==null?void 0:t.code})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Tutup"})})]})})]})}export{be as default};
