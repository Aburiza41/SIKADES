import{r as t,j as s,L as ae,a as te}from"./app-cnLqKnWv.js";import{S as k}from"./sweetalert2.esm.all-LHqzTR4y.js";import{A as se}from"./AuthenticatedLayout-DtE7q2g1.js";import{c as oe,l as ie,m as re}from"./index-CyDsHmf4.js";import ne from"./OfficialIdentifyForm-BJ9dCHbk.js";import fe from"./StudiesForm-Cx_dz5WU.js";import ce from"./OfficialTempatKerjaForm-CS1EnpOv.js";import le from"./OrangTuaForm-CSrBZQ3v.js";import me from"./HubunganForm-CjiLbhrS.js";import ue from"./AnakForm-ChAMw0W0.js";import pe from"./PositionsForm-BkfhjPQI.js";import de from"./TrainingsForm-Dv3dJMEo.js";import he from"./OrganizationsForm-C7R7fV2x.js";import{m as j}from"./proxy-0toHJmZX.js";import"./index-sj701c6h.js";import"./iconBase-CMF4PMHw.js";import"./transition-LX_87-cn.js";import"./LoadingPage-CsjTuYab.js";import"./index-CSb7vC3W.js";import"./index-DC9iVcT_.js";import"./index-DidX0__a.js";import"./react-select.esm-kjDh-dq3.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";var G;const ge=((G=document.querySelector('meta[name="csrf-token"]'))==null?void 0:G.getAttribute("content"))||"";function Re({official:v,studies:w,initialPositions:Q,position:c,initialOrganizations:S,currentPosition:D,anak:N,initialTrainings:$,orang_tua:L,pasangan:P,id:_,jabatan:l,tempat_kerja:A}){var q;const f=(n,o)=>{localStorage.setItem(`officialForm_${n}`,JSON.stringify(o))},[r,B]=t.useState(v||{}),[m,H]=t.useState(A||{}),[d,C]=t.useState(w||[]),[u,K]=t.useState(D||{}),[h,T]=t.useState($||[]),[g,E]=t.useState(S||[]),[x,U]=t.useState(L||[]),[p,z]=t.useState(P||{}),[y,I]=t.useState(N||[]),[F,R]=t.useState(!1),[b,W]=t.useState({});t.useEffect(()=>{f("official",r)},[r]),t.useEffect(()=>{f("officialTempatKerja",m)},[m]),t.useEffect(()=>{f("officialStudies",d)},[d]),t.useEffect(()=>{f("officialPosition",u)},[u]),t.useEffect(()=>{f("officialTrainings",h)},[h]),t.useEffect(()=>{f("officialOrganizations",g)},[g]),t.useEffect(()=>{f("orangTua",x)},[x]),t.useEffect(()=>{f("hubungan",p)},[p]),t.useEffect(()=>{f("anak",y)},[y]),t.useEffect(()=>{const n=o=>{if(Object.keys(r).length>0||Object.keys(m).length>0||d.length>0||Object.keys(u).length>0||h.length>0||g.length>0||x.length>0||Object.keys(p).length>0||y.length>0)return o.preventDefault(),o.returnValue="Anda memiliki data yang belum tersimpan. Apakah Anda yakin ingin meninggalkan halaman ini?",o.returnValue};return window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n)}},[r,m,d,u,h,g,x,p,y]);const V=()=>{["official","officialTempatKerja","officialStudies","officialPosition","officialTrainings","officialOrganizations","orangTua","hubungan","anak"].forEach(n=>localStorage.removeItem(`officialForm_${n}`))},Z=async n=>{var O,J,M,X,Y;n.preventDefault(),R(!0);const o=new FormData;for(const e in r)e==="foto"&&r[e]instanceof File?o.append(`official[${e}]`,r[e]):o.append(`official[${e}]`,r[e]??"");for(const e in m)o.append(`tempat_kerja[${e}]`,m[e]??"");for(const e in u)o.append(`position[${e}]`,u[e]??"");g.forEach((e,i)=>{for(const a in e)a==="doc_scan"&&e[a]instanceof File?o.append(`organizations[${i}][${a}]`,e[a]):o.append(`organizations[${i}][${a}]`,e[a]??"")}),d.forEach((e,i)=>{for(const a in e)a==="doc_scan"&&e[a]instanceof File?o.append(`studies[${i}][${a}]`,e[a]):o.append(`studies[${i}][${a}]`,e[a]??"")}),h.forEach((e,i)=>{for(const a in e)a==="doc_scan"&&e[a]instanceof File?o.append(`trainings[${i}][${a}]`,e[a]):o.append(`trainings[${i}][${a}]`,e[a]??"")}),x.forEach((e,i)=>{for(const a in e)e[a]!==void 0&&e[a]!==null&&o.append(`orang_tua[${i}][${a}]`,e[a])});for(const e in p)o.append(`hubungan[${e}]`,p[e]??"");y.forEach((e,i)=>{for(const a in e)o.append(`anak[${i}][${a}]`,e[a]??"")});try{const e=await te.post(`/village/official/${((O=c==null?void 0:c.position)==null?void 0:O.slug)??(l==null?void 0:l.slug)}/${_}/edit`,o,{headers:{"Content-Type":"multipart/form-data","X-CSRF-TOKEN":ge}});V(),k.fire("Success","Data berhasil diperbarui.","success")}catch(e){k.fire("Error",((M=(J=e.response)==null?void 0:J.data)==null?void 0:M.message)||"Terjadi kesalahan","error"),W(((Y=(X=e.response)==null?void 0:X.data)==null?void 0:Y.errors)||{})}finally{R(!1)}},ee=()=>{k.fire({title:"Bersihkan Form?",text:"Semua data yang belum tersimpan akan dihapus. Anda yakin?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&(B(v||{}),H(A||{}),C(w||[]),K(D||{}),T($||[]),E(S||[]),U(L||[]),z(P||{}),I(N||[]),V(),k.fire("Dihapus!","Form telah berhasil dibersihkan.","success").then(()=>{window.location.reload()}))})};return s.jsxs(se,{header:s.jsxs("div",{className:"text-2xl font-semibold leading-tight",children:["Ubah Pejabat Desa ",r.nama_lengkap||"Pejabat",s.jsx("p",{className:"text-sm font-thin mt-1",children:"Formulir Perubahan Data Pejabat Desa"})]}),breadcrumb:[{name:"Ubah Pejabat Desa",path:`/village/official/edit/${((q=c==null?void 0:c.position)==null?void 0:q.slug)??(l==null?void 0:l.slug)}/${_}`,active:!0,icon:s.jsx(re,{className:"w-5 h-5 mr-3"})}],children:[s.jsx(ae,{title:"Update Official"}),s.jsx(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"p-4",children:s.jsxs("form",{onSubmit:Z,className:"space-y-8",children:[s.jsx(ne,{official:r,setOfficial:B,errors:b}),s.jsx(ce,{tempat_kerja:m,setTempatKerja:H,errors:b}),s.jsx(pe,{jabatan:l,position:c,positions:Q,officialPosition:u,setOfficialPosition:K}),s.jsx(he,{organizations:S,setOrganizations:E,officialOrganizations:g,setOfficialOrganizations:E}),s.jsx(fe,{officialStudies:d,setOfficialStudies:C}),s.jsx(de,{trainings:$,setTrainings:T,officialTrainings:h,setOfficialTrainings:T}),s.jsx(le,{orang_tua:x,setOrangTua:U,errors:b}),s.jsx(me,{hubungan:p,setHubungan:z,errors:b}),s.jsx(ue,{anak:y,setAnak:I,errors:b}),s.jsxs(j.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"flex justify-end mt-8",children:[s.jsxs(j.button,{type:"button",onClick:ee,whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center mr-4",disabled:F,children:[s.jsx(oe,{className:"mr-2"}),"Reset Form"]}),s.jsxs(j.button,{type:"submit",whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center",disabled:F,children:[s.jsx(ie,{className:"mr-2"}),F?"Menyimpan...":"Simpan Perubahan"]})]})]})})]})}export{Re as default};
