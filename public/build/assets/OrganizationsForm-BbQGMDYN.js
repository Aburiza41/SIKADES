import{r as s,j as e,a as K}from"./app-cnLqKnWv.js";import{a as D,b as F,c as Y}from"./index-CyDsHmf4.js";import{S as $}from"./react-select.esm-kjDh-dq3.js";import{S as l}from"./sweetalert2.esm.all-LHqzTR4y.js";import{m as i}from"./proxy-0toHJmZX.js";import{A}from"./index-CSb7vC3W.js";import"./iconBase-CMF4PMHw.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";function ie({organizations:T=[],setOrganizations:P=()=>{},officialOrganizations:n=[],setOfficialOrganizations:p=()=>{}}){const[B,N]=s.useState(!1),[M,w]=s.useState(!1),[g,v]=s.useState(""),[k,O]=s.useState(""),[r,o]=s.useState(null),[h,c]=s.useState(""),[b,d]=s.useState(""),[H,m]=s.useState(null),[S,x]=s.useState(""),[u,y]=s.useState(null),_=T.map(a=>({value:a.id,label:a.title})),E=()=>N(!0),f=()=>{N(!1),v(""),O("")},C=(a=null)=>{if(a!==null){const t=n[a];o({value:t.organization_id,label:t.organization_title}),c(t.nama),d(t.posisi),m(t.doc_scan||null),x(t.keterangan||""),y(a)}else o(null),c(""),d(""),m(null),x(""),y(null);w(!0)},z=()=>{w(!1),o(null),c(""),d(""),m(null),x(""),y(null)},J=async()=>{if(!g.trim()){l.fire({icon:"error",title:"Oops...",text:"Judul organisasi tidak boleh kosong!"});return}try{const a=await K.post("/village/official/organization/store",{title:g,description:k});if(a.data.success){const t={id:a.data.data.id,title:a.data.data.title,description:a.data.data.description};P(j=>[...j,t]),f()}else l.fire({icon:"error",title:"Gagal",text:"Gagal menambahkan organisasi baru: "+a.data.message})}catch(a){console.error("Gagal menambahkan organisasi baru:",a),l.fire({icon:"error",title:"Gagal",text:"Terjadi kesalahan saat menambahkan organisasi baru. Silakan coba lagi."}),f()}},R=()=>{if(!r||!h||!b){l.fire({icon:"error",title:"Oops...",text:"Harap isi semua field yang diperlukan!"});return}const a={organization_id:r.value,organization_title:r.label,nama:h,posisi:b,doc_scan:H,keterangan:S};if(u!==null){const t=[...n];t[u]=a,p(t)}else p([...n,a]);z()},G=a=>{l.fire({title:"Apakah Anda yakin?",text:"Data yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(t=>{if(t.isConfirmed){const j=n.filter((q,I)=>I!==a);p(j),l.fire("Dihapus!","Data telah dihapus.","success")}})};return e.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"bg-white w-full p-6 shadow rounded-lg mt-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 pb-4 border-b",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-800",children:"H. Formulir Riwayat Organisasi"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Formulir ini digunakan untuk mengisi riwayat organisasi pejabat desa."})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(i.button,{type:"button",onClick:E,whileHover:{scale:1.03},whileTap:{scale:.98},className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center text-sm",children:[e.jsx(D,{className:"mr-2"})," Jenis Organisasi"]}),e.jsxs(i.button,{type:"button",onClick:()=>C(),whileHover:{scale:1.03},whileTap:{scale:.98},className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center text-sm",children:[e.jsx(D,{className:"mr-2"})," Tambah Riwayat"]})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Organisasi"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Posisi"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Keterangan"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.length>0?n.map((a,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:a.organization_title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:a.nama}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-800",children:a.posisi}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-800 max-w-xs truncate",children:a.keterangan||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",onClick:()=>C(t),className:"px-3 py-1 bg-yellow-500 text-white rounded-md hover:bg-yellow-600 flex items-center text-xs",children:[e.jsx(F,{className:"mr-1"})," Edit"]}),e.jsxs("button",{type:"button",onClick:()=>G(t),className:"px-3 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center text-xs",children:[e.jsx(Y,{className:"mr-1"})," Hapus"]})]})})]},t)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"Tidak ada data riwayat organisasi."})})})]})})]}),e.jsx(A,{children:B&&e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx(i.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Tambah Jenis Organisasi Baru"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Judul Organisasi"}),e.jsx("input",{type:"text",value:g,onChange:a=>v(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Judul Organisasi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deskripsi"}),e.jsx("textarea",{value:k,onChange:a=>O(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Deskripsi Organisasi",rows:"3"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:f,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Batal"}),e.jsx("button",{type:"button",onClick:J,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Simpan"})]})]})})})}),e.jsx(A,{children:M&&e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx(i.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:u!==null?"Edit Riwayat Organisasi":"Tambah Riwayat Organisasi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Organisasi"}),e.jsx($,{options:_,value:r,onChange:o,placeholder:"Pilih Organisasi",isClearable:!0,isSearchable:!0,className:"basic-single",classNamePrefix:"select"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nama"}),e.jsx("input",{type:"text",value:h,onChange:a=>c(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nama"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posisi"}),e.jsx("input",{type:"text",value:b,onChange:a=>d(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Posisi"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dokumen"}),e.jsx("input",{type:"file",onChange:a=>m(a.target.files[0]),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keterangan"}),e.jsx("textarea",{value:S,onChange:a=>x(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Keterangan",rows:"3"})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:z,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Batal"}),e.jsx("button",{type:"button",onClick:R,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:u!==null?"Simpan Perubahan":"Simpan"})]})]})})})})]})}export{ie as default};
