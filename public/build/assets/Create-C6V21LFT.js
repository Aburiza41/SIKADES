import{r as t,j as i,L as J,a as V}from"./app-cnLqKnWv.js";import{S as y}from"./sweetalert2.esm.all-LHqzTR4y.js";import{A as q}from"./AuthenticatedLayout-DtE7q2g1.js";import{c as M,l as Y,m as G}from"./index-CyDsHmf4.js";import Q from"./OfficialIdentifyForm-BJ9dCHbk.js";import W from"./StudiesForm-Cx_dz5WU.js";import X from"./OfficialTempatKerjaForm-CS1EnpOv.js";import Z from"./OrangTuaForm-CSrBZQ3v.js";import ee from"./HubunganForm-CjiLbhrS.js";import ae from"./AnakForm-ChAMw0W0.js";import te from"./PositionsForm-BkfhjPQI.js";import ie from"./TrainingsForm-Dv3dJMEo.js";import oe from"./OrganizationsForm-C7R7fV2x.js";import{m as k}from"./proxy-0toHJmZX.js";import"./index-sj701c6h.js";import"./iconBase-CMF4PMHw.js";import"./transition-LX_87-cn.js";import"./LoadingPage-CsjTuYab.js";import"./index-CSb7vC3W.js";import"./index-DC9iVcT_.js";import"./index-DidX0__a.js";import"./react-select.esm-kjDh-dq3.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";var K;(K=document.querySelector('meta[name="csrf-token"]'))!=null&&K.getAttribute("content");function Ae({initialPositions:P,initialOrganizations:_,initialTrainings:I,position:E,jabatan:S}){const r=(n,l)=>{const o=localStorage.getItem(`officialForm_${n}`);return o?JSON.parse(o):l},f=(n,l)=>{localStorage.setItem(`officialForm_${n}`,JSON.stringify(l))},[c,v]=t.useState(r("official",[])),[m,F]=t.useState(r("officialTempatKerja",[])),[d,w]=t.useState(r("officialStudies",[])),[p,N]=t.useState(r("officialPosition",[])),[h,T]=t.useState(r("officialTrainings",[])),[g,O]=t.useState(r("officialOrganizations",[])),[b,D]=t.useState(r("orangTua",[])),[u,A]=t.useState(r("hubungan",[])),[j,L]=t.useState(r("anak",[])),[$,B]=t.useState(!1),[x,ne]=t.useState({});t.useEffect(()=>{f("official",c)},[c]),t.useEffect(()=>{f("officialTempatKerja",m)},[m]),t.useEffect(()=>{f("officialStudies",d)},[d]),t.useEffect(()=>{f("officialPosition",p)},[p]),t.useEffect(()=>{f("officialTrainings",h)},[h]),t.useEffect(()=>{f("officialOrganizations",g)},[g]),t.useEffect(()=>{f("orangTua",b)},[b]),t.useEffect(()=>{f("hubungan",u)},[u]),t.useEffect(()=>{f("anak",j)},[j]),t.useEffect(()=>{const n=l=>{if(Object.keys(c).length>0||Object.keys(m).length>0||d.length>0||Object.keys(p).length>0||h.length>0||g.length>0||b.length>0||Object.keys(u).length>0||j.length>0)return l.preventDefault(),l.returnValue="Anda memiliki data yang belum tersimpan. Apakah Anda yakin ingin meninggalkan halaman ini?",l.returnValue};return window.addEventListener("beforeunload",n),()=>{window.removeEventListener("beforeunload",n)}},[c,m,d,p,h,g,b,u,j]);const H=()=>{["official","officialTempatKerja","officialStudies","officialPosition","officialTrainings","officialOrganizations","orangTua","hubungan","anak"].forEach(n=>localStorage.removeItem(`officialForm_${n}`))},R=async(n,l)=>{var z,C;n.preventDefault(),B(!0);const o=new FormData;for(const e in c)e==="foto"&&c[e]instanceof File?o.append(`official[${e}]`,c[e]):o.append(`official[${e}]`,c[e]);for(const e in m)o.append(`tempat_kerja[${e}]`,m[e]);for(const e in p)o.append(`position[${e}]`,p[e]);g.forEach((e,s)=>{for(const a in e)a==="doc_scan"&&e[a]instanceof File?o.append(`organizations[${s}][${a}]`,e[a]):o.append(`organizations[${s}][${a}]`,e[a])}),d.forEach((e,s)=>{for(const a in e)a==="doc_scan"&&e[a]instanceof File?o.append(`studies[${s}][${a}]`,e[a]):o.append(`studies[${s}][${a}]`,e[a])}),h.forEach((e,s)=>{for(const a in e)a==="doc_scan"&&e[a]instanceof File?o.append(`trainings[${s}][${a}]`,e[a]):o.append(`trainings[${s}][${a}]`,e[a])}),b.forEach((e,s)=>{for(const a in e)e[a]!==void 0&&e[a]!==null&&o.append(`orang_tua[${s}][${a}]`,e[a])});for(const e in u)o.append(`hubungan[${e}]`,u[e]);j.forEach((e,s)=>{for(const a in e)o.append(`anak[${s}][${a}]`,e[a])});try{const e=await V.post(`/village/official/${l}/store`,o,{headers:{"Content-Type":"multipart/form-data"}});H(),y.fire("Success","Data berhasil diperbarui.","success")}catch(e){y.fire("Error",((C=(z=e.response)==null?void 0:z.data)==null?void 0:C.message)||"Terjadi kesalahan","error")}finally{B(!1)}},U=()=>{y.fire({title:"Bersihkan Form?",text:"Semua data yang belum tersimpan akan dihapus. Anda yakin?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus!",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&(v([]),F([]),w([]),N([]),T([]),O([]),D([]),A([]),L([]),H(),y.fire("Dihapus!","Form telah berhasil dibersihkan.","success").then(()=>{window.location.reload()}))})};return i.jsxs(q,{header:i.jsxs("div",{className:"text-2xl font-semibold leading-tight",children:["Tambah ",S.name,i.jsxs("p",{className:"text-sm font-thin mt-1",children:["Tambah pejabat desa dengan jabatan ",S.name]})]}),breadcrumb:[{name:"Tambah Official",path:"/village/official/create",active:!0,icon:i.jsx(G,{className:"w-5 h-5 mr-3"})}],children:[i.jsx(J,{title:"Update Official"}),i.jsx(k.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"p-4",children:i.jsxs("form",{onSubmit:n=>R(n,E),className:"space-y-8",children:[i.jsx(Q,{official:c,setOfficial:v,errors:x}),i.jsx(X,{tempat_kerja:m,setTempatKerja:F,errors:x}),i.jsx(te,{jabatan:S,position:E,positions:P,officialPosition:p,setOfficialPosition:N}),i.jsx(oe,{organizations:_,setOrganizations:O,officialOrganizations:g,setOfficialOrganizations:O}),i.jsx(W,{officialStudies:d,setOfficialStudies:w}),i.jsx(ie,{trainings:I,setTrainings:T,officialTrainings:h,setOfficialTrainings:T}),i.jsx(Z,{orang_tua:b,setOrangTua:D,errors:x}),i.jsx(ee,{hubungan:u,setHubungan:A,errors:x}),i.jsx(ae,{anak:j,setAnak:L,errors:x}),i.jsxs(k.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"flex justify-end mt-8",children:[i.jsxs(k.button,{type:"button",onClick:U,whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 flex items-center",disabled:$,children:[i.jsx(M,{className:"mr-2"})," ","Reset Form"]}),i.jsxs(k.button,{type:"submit",whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 flex items-center",disabled:$,children:[i.jsx(Y,{className:"mr-2"}),$?"Menyimpan...":"Simpan Perubahan"]})]})]})})]})}export{Ae as default};
