import{K as R,r as s,S as g,j as e,L as $}from"./app-cnLqKnWv.js";import{S as r}from"./sweetalert2.esm.all-LHqzTR4y.js";import{A as q}from"./AuthenticatedLayout-DtE7q2g1.js";import H from"./List-DFQY4Zrt.js";import N from"./Modal-CpIYc9ke.js";import{a as J,m as U}from"./index-CyDsHmf4.js";import"./index-sj701c6h.js";import"./iconBase-CMF4PMHw.js";import"./transition-LX_87-cn.js";import"./LoadingPage-CsjTuYab.js";import"./proxy-0toHJmZX.js";import"./index-CSb7vC3W.js";import"./xlsx-5rFX-EW9.js";var w;const v=((w=document.querySelector('meta[name="csrf-token"]'))==null?void 0:w.getAttribute("content"))||"";function ne({trainings:k,sort:C,search:E}){const{flash:a}=R().props,[P,D]=s.useState(k),[T,f]=s.useState(!1),[x,B]=s.useState(C||{}),[j,O]=s.useState(E||""),[S,l]=s.useState(!1),[c,u]=s.useState(!1),[y,m]=s.useState(!1),[i,h]=s.useState(null),[o,d]=s.useState({title:"",description:""});s.useEffect(()=>{a!=null&&a.success&&r.fire("Success",a.success,"success"),a!=null&&a.error&&r.fire("Error",a.error,"error")},[a]);const b=s.useCallback((t={})=>{f(!0),g.get("/admin/training",{page:t.page||1,per_page:t.perPage||10,search:t.search||j,sort_field:t.sortField||x.sort_field,sort_direction:t.sortDirection||x.sort_direction},{preserveState:!0,replace:!0,onSuccess:n=>{D(n.props.trainings),B(n.props.sort||{}),O(n.props.search||""),f(!1)},onError:()=>{r.fire("Error","Failed to fetch data. Please try again.","error"),f(!1)}})},[j,x]),A=()=>{u(!1),m(!1),l(!0),h(null),d({title:"",description:""})},M=t=>{h(t),u(!0),m(!1),l(!0),d({title:t.title||"",description:t.description||""})},L=t=>{h(t),u(!1),m(!0),l(!0)},_=t=>{r.fire({title:"Apakah Anda yakin?",text:"Data ini akan dihapus permanen!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal"}).then(n=>{n.isConfirmed&&g.delete(`/admin/training/${t}`,{headers:{"X-CSRF-TOKEN":v},onSuccess:()=>{r.fire("Terhapus!","Data berhasil dihapus.","success"),b({})},onError:()=>{r.fire("Error","Terjadi kesalahan saat menghapus data.","error")}})})},F=t=>{t.preventDefault();const n=c?`/admin/training/${i.id}`:"/admin/training",V=c?"put":"post",I={title:o.title,description:o.description};g[V](n,I,{headers:{"X-CSRF-TOKEN":v},onSuccess:()=>{r.fire("Success",`Pelatihan ${c?"diperbarui":"ditambahkan"} berhasil.`,"success"),l(!1),b({})},onError:K=>{r.fire("Error",Object.values(K).join(", "),"error")}})},p=()=>{l(!1),u(!1),m(!1),h(null),d({title:"",description:""})};return e.jsxs(q,{header:e.jsxs("div",{className:"text-2xl font-semibold leading-tight",children:["Pelatihan",e.jsx("p",{className:"text-sm font-thin mt-1",children:"Daftar Pelatihan Pegawai"})]}),breadcrumb:[{name:"Pelatihan",path:"/admin/training",active:!0,icon:e.jsx(U,{className:"w-5 h-5 mr-3"})}],children:[e.jsx($,{title:"Pelatihan"}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{}),e.jsxs("button",{onClick:A,className:"inline-flex items-center px-4 py-2 bg-blue-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition ease-in-out duration-150",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Tambah Pelatihan"]})]}),e.jsx(H,{trainings:P,fetchData:b,loading:T,onEdit:M,onDelete:_,onView:L})]}),e.jsx(N,{isOpen:S&&!y,onClose:p,title:c?"Edit Pelatihan":"Tambah Pelatihan",children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Judul Pelatihan"}),e.jsx("input",{type:"text",value:o.title,onChange:t=>d({...o,title:t.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deskripsi"}),e.jsx("textarea",{value:o.description,onChange:t=>d({...o,description:t.target.value}),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:c?"Update":"Simpan"})]})]})})}),e.jsx(N,{isOpen:S&&y,onClose:p,title:"Detail Pelatihan",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Judul Pelatihan"}),e.jsx("p",{className:"mt-1 text-gray-900",children:(i==null?void 0:i.title)||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Deskripsi"}),e.jsx("p",{className:"mt-1 text-gray-900",children:(i==null?void 0:i.description)||"-"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:p,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Tutup"})})]})})]})}export{ne as default};
