import{K as Z,r,j as e,L as U,S as y}from"./app-EIz8nQ5Q.js";import{S as n}from"./sweetalert2.esm.all-LHqzTR4y.js";import{A as ee}from"./AuthenticatedLayout-DaJ7Bo11.js";import ae from"./List-CnerJ7Q2.js";import{a as le}from"./index-D-VSm5dn.js";import{c as te,a as v,b as j,d as se,e as ie}from"./index.esm-D5dJ1EDf.js";import re from"./PDF-BcDREAqB.js";import O from"./Modal-CNNQmiLs.js";import{S as _}from"./react-select.esm-Q-Xj6kKm.js";import"./index-CuuF2Vom.js";import"./iconBase-CIswt8ol.js";import"./transition-DuUQTJM_.js";import"./LoadingPage-DIqH4F6W.js";import"./proxy-Br4hXrCY.js";import"./index-26-9MRme.js";import"./xlsx-5rFX-EW9.js";import"./Actions-DSO6e13q.js";import"./index-BTPrMAX7.js";import"./index-Yda8cguo.js";import"./jspdf.plugin.autotable-C7mnqvEA.js";import"./typeof-QjJsDpFa.js";import"./defineProperty-DRmM3rRU.js";import"./index-B8EcdQ8U.js";te().shape({id:ie().nullable(),name:j().required("Nama wajib diisi"),email:j().email("Email tidak valid").required("Email wajib diisi"),email_verified_at:v().nullable(),role:se().oneOf(["admin","regency","district","village"],"Role tidak valid").default("village"),remember_token:j().nullable(),created_at:v().nullable(),updated_at:v().nullable()});const T=document.querySelector('meta[name="csrf-token"]').getAttribute("content");function Re({initialUsers:B,regencies:N,districts:S,villages:w,userRegency:ne}){var C,A,D,R,V,$,P,M,L;const{flash:o}=Z().props,[F,q]=r.useState(B),[I,b]=r.useState(!1),[k,c]=r.useState(!1),[m,x]=r.useState(!1),[E,h]=r.useState(!1),[l,p]=r.useState(null),[t,s]=r.useState({name:"",email:"",role:"admin",regency_id:"",district_id:"",village_id:""});r.useEffect(()=>{o.success&&n.fire("Success",o.success,"success"),o.error&&n.fire("Error",o.error,"error")},[o]);const f=({page:a=1,perPage:i=10,search:u="",filters:d="",sortField:J="",sortDirection:Q=""})=>{b(!0),y.get("/regency/user",{page:a,per_page:i,search:u,filters:d,sort_field:J,sort_direction:Q},{preserveState:!0,replace:!0,onSuccess:W=>{q(W.props.initialUsers),b(!1)},onError:()=>{n.fire("Error","Failed to fetch data. Please try again.","error"),b(!1)}})},K=()=>{x(!1),h(!1),c(!0),s({name:"",email:"",role:"admin",regency_id:"",district_id:"",village_id:""})},X=a=>{var i,u,d;p(a),x(!0),h(!1),c(!0),s({name:a.name,email:a.email,role:a.role,regency_id:((i=a.user_regency)==null?void 0:i.regency_id)||"",district_id:((u=a.user_district)==null?void 0:u.district_id)||"",village_id:((d=a.user_village)==null?void 0:d.village_id)||""})},H=a=>{p(a),x(!1),h(!0),c(!0)},Y=a=>{n.fire({title:"Are you sure?",text:"This data will be deleted!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(i=>{i.isConfirmed&&y.delete(`/regency/user/${a}`,{headers:{"X-CSRF-TOKEN":T},onSuccess:()=>{n.fire("Deleted!","Data has been successfully deleted.","success"),f({})},onError:()=>{n.fire("Error","An error occurred while deleting the data.","error")}})})},z=a=>{re(a)},G=a=>{a.preventDefault();const i=m?`/regency/user/${l.id}`:"/regency/user";y[m?"put":"post"](i,t,{headers:{"X-CSRF-TOKEN":T},onSuccess:()=>{n.fire("Success",`User ${m?"updated":"added"} successfully.`,"success"),c(!1),f({})},onError:d=>{n.fire("Error",Object.values(d).join(", "),"error")}})},g=()=>{c(!1),x(!1),h(!1),p(null),s({name:"",email:"",role:"regency",regency_id:"",district_id:"",village_id:""})};return e.jsxs(ee,{header:e.jsxs("div",{className:"text-2xl font-semibold leading-tight",children:["Users",e.jsx("p",{className:"text-sm font-thin mt-1",children:"Daftar Pengguna"})]}),breadcrumb:[{name:"Users",path:"/regency/users",active:!0,icon:e.jsx(le,{className:"w-5 h-5 mr-3"})}],children:[e.jsx(U,{title:"Users"}),e.jsxs("div",{className:"p-4",children:[e.jsx("button",{onClick:K,className:"mb-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Add User"}),e.jsx(ae,{users:F,fetchData:f,loading:I,onEdit:X,onDelete:Y,onView:H,onPrint:z})]}),e.jsx(O,{isOpen:k&&!E,onClose:g,title:m?"Edit User":"Add User",children:e.jsx("div",{className:"p-4",children:e.jsxs("form",{onSubmit:G,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:t.name,onChange:a=>s({...t,name:a.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",value:t.email,onChange:a=>s({...t,email:a.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsxs("select",{value:t.role,onChange:a=>s({...t,role:a.target.value}),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm",children:[e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"regency",children:"Regency"}),e.jsx("option",{value:"district",children:"District"}),e.jsx("option",{value:"village",children:"Village"})]})]}),t.role==="regency"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Regency"}),e.jsx(_,{options:N.map(a=>({value:a.id,label:a.name_bps})),value:t.regency_id?{value:t.regency_id,label:(C=N.find(a=>a.id===t.regency_id))==null?void 0:C.name_bps}:null,onChange:a=>s({...t,regency_id:a?a.value:""}),placeholder:"Pilih Regency",isSearchable:!0})]}),t.role==="district"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"District"}),e.jsx(_,{options:S.map(a=>({value:a.id,label:a.name_bps})),value:t.district_id?{value:t.district_id,label:(A=S.find(a=>a.id===t.district_id))==null?void 0:A.name_bps}:null,onChange:a=>s({...t,district_id:a?a.value:""}),placeholder:"Pilih District",isSearchable:!0})]}),t.role==="village"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Village"}),e.jsx(_,{options:w.map(a=>({value:a.id,label:a.name_bps})),value:t.village_id?{value:t.village_id,label:(D=w.find(a=>a.id===t.village_id))==null?void 0:D.name_bps}:null,onChange:a=>s({...t,village_id:a?a.value:""}),placeholder:"Pilih Village",isSearchable:!0})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{type:"button",onClick:g,className:"mr-2 px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:m?"Update":"Save"})]})]})})}),e.jsx(O,{isOpen:k&&E,onClose:g,title:"View User",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("p",{className:"mt-1 text-gray-900",children:l==null?void 0:l.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-gray-900",children:l==null?void 0:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("p",{className:"mt-1 text-gray-900",children:l==null?void 0:l.role})]}),(l==null?void 0:l.role)==="regency"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Regency"}),e.jsx("p",{className:"mt-1 text-gray-900",children:((V=(R=l==null?void 0:l.user_regency)==null?void 0:R.regency)==null?void 0:V.name_bps)||"N/A"})]}),(l==null?void 0:l.role)==="district"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"District"}),e.jsx("p",{className:"mt-1 text-gray-900",children:((P=($=l==null?void 0:l.user_district)==null?void 0:$.district)==null?void 0:P.name_bps)||"N/A"})]}),(l==null?void 0:l.role)==="village"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Village"}),e.jsx("p",{className:"mt-1 text-gray-900",children:((L=(M=l==null?void 0:l.user_village)==null?void 0:M.village)==null?void 0:L.name_bps)||"N/A"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:g,className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Close"})})]})})]})}export{Re as default};
