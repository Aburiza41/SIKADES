import{K as ee,r as n,j as e}from"./app-cnLqKnWv.js";import{S as F}from"./sweetalert2.esm.all-LHqzTR4y.js";import{O as te,E as se,P as ae,o as re,d as ne,L as le,M as ce,N as de}from"./index-sj701c6h.js";import oe from"./Actions-BBmxNL5h.js";import ie from"./Procces-DtG0Kf15.js";import{m as b}from"./proxy-0toHJmZX.js";import"./iconBase-CMF4PMHw.js";import"./index-CoBPEikz.js";function ye({officials:s,fetchData:C,regencyCode:k,loading:D,onEdit:_,onDelete:E,onView:M,onPrint:T,position:v,onAccept:$,onReject:A,role:K}){var P;ee().props.auth.user;const[p,L]=n.useState(""),[m,R]=n.useState(""),[r,h]=n.useState((s==null?void 0:s.current_page)||1),[c,O]=n.useState((s==null?void 0:s.per_page)||10),[o,U]=n.useState("id"),[i,f]=n.useState("asc"),[H,I]=n.useState([]),[B,S]=n.useState([]),[d,J]=n.useState(""),[u,y]=n.useState(""),q=["SD/MI","SMP/MTS","SMA/SMK/MA","D1","D2","D3","D4","S1","S2","S3"];n.useEffect(()=>{C({page:r,perPage:c,search:p,filters:m,sortField:o,sortDirection:i,kecamatan:d,desa:u})},[r,c,p,m,o,i,d,u]);const N=t=>h(t),G=t=>{O(Number(t.target.value)),h(1)},g=t=>{o===t?f(i==="asc"?"desc":"asc"):(U(t),f("asc"))},w=async t=>{try{const a={page:r,per_page:c,search:p,filters:m,sort_field:o,sort_direction:i,kecamatan:d,desa:u},l=await axios.get(`/admin/official/${v.slug}/export/${t}`,{params:a,responseType:"blob"}),Y={json:"json",excel:"xlsx",pdf:"pdf"},Z={json:"application/json",excel:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",pdf:"application/pdf"},z=window.URL.createObjectURL(new Blob([l.data],{type:Z[t]})),x=document.createElement("a");x.href=z,x.setAttribute("download",`Pejabat_${v.slug}_${new Date().toLocaleDateString()}.${Y[t]}`),document.body.appendChild(x),x.click(),x.remove(),F.fire("Success",`${t.toUpperCase()} exported successfully!`,"success")}catch(a){console.error(`Export ${t} error:`,a),F.fire("Error",`Failed to export ${t.toUpperCase()}. Please try again.`,"error")}},Q=()=>w("json"),V=()=>w("excel"),W=()=>w("pdf"),j=t=>o!==t?e.jsx(le,{className:"ml-1"}):i==="asc"?e.jsx(ce,{className:"ml-1"}):e.jsx(de,{className:"ml-1"}),X=({role:t})=>{let a="",l="";switch(t){case"tolak":a="bg-red-500",l="Tolak";break;case"daftar":a="bg-blue-500",l="Daftar";break;case"validasi":a="bg-green-500",l="Terima";break;case"proses":a="bg-yellow-500",l="Proses";break;default:a="bg-gray-500",l="Tidak Diketahui"}return e.jsx("span",{className:`px-2 py-1 text-xs text-white rounded-full ${a}`,children:l})};return n.useEffect(()=>{axios.get(`/regency/bps/wilayah/kecamatan/${k.code_bps}`).then(t=>I(t.data))},[k.code_bps]),n.useEffect(()=>{if(!d){S([]),y("");return}axios.get(`/regency/bps/wilayah/desa/${d}`).then(t=>S(t.data))},[d]),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg border border-gray-300",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[e.jsxs("div",{className:"flex gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsx("label",{htmlFor:"search",className:"text-sm font-medium",children:"Pecarian"}),e.jsx(b.input,{type:"text",id:"search",name:"search",placeholder:"Pencarian ...",value:p,onChange:t=>L(t.target.value),className:"border p-2 rounded focus:outline-none focus:ring-2 focus:ring-green-500 w-full md:w-auto",whileHover:{scale:1.02},whileFocus:{scale:1.02},transition:{type:"spring",stiffness:300}})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"education",className:"text-sm font-medium",children:"Pendidikan"}),e.jsxs("select",{id:"education",name:"education",value:m,onChange:t=>R(t.target.value),className:"border rounded focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Semua"}),q.map((t,a)=>e.jsx("option",{value:t,children:t},a))]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"kecamatan",className:"text-sm font-medium",children:"Kecamatan"}),e.jsxs("select",{id:"kecamatan",value:d,onChange:t=>{J(t.target.value),y(""),h(1)},className:"border rounded focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Semua Kecamatan"}),H.map(t=>e.jsx("option",{value:t.kode_bps,children:t.nama_bps},t.kode_bps))]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"desa",className:"text-sm font-medium",children:"Desa"}),e.jsxs("select",{id:"desa",value:u,onChange:t=>{y(t.target.value),h(1)},disabled:!d,className:"border rounded focus:outline-none focus:ring-2 focus:ring-green-500 disabled:bg-gray-100",children:[e.jsx("option",{value:"",children:"Semua Desa"}),B.map(t=>e.jsx("option",{value:t.kode_bps,children:t.nama_bps},t.kode_bps))]})]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto justify-end",children:[e.jsxs(b.button,{onClick:Q,className:"bg-green-700 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(te,{className:"mr-2"})," JSON"]}),e.jsxs(b.button,{onClick:W,className:"bg-green-700 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(se,{className:"mr-2"})," PDF"]}),e.jsxs(b.button,{onClick:V,className:"bg-green-700 text-white px-4 py-2 rounded-lg flex items-center",whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:300},children:[e.jsx(ae,{className:"mr-2"})," Excel"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs border",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"70px"},children:"No"}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"250px"},onClick:()=>g("nama_lengkap"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["Nama Lengkap",j("nama_lengkap")]})}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},onClick:()=>g("nik"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["NIK",j("nik")]})}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},onClick:()=>g("nipd"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["NIPD",j("nipd")]})}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"150px"},onClick:()=>g("pendidikan"),children:e.jsxs("div",{className:"flex items-center cursor-pointer",children:["Pendidikan",j("pendidikan")]})}),e.jsx("th",{className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Desa"}),e.jsx("th",{className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kecamatan"}),e.jsx("th",{className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"120px"},children:"Proses"}),e.jsx("th",{scope:"col",className:"px-2 py-2 border text-left text-xs font-medium text-gray-500 uppercase tracking-wider",style:{width:"120px"},children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-2 py-4 border text-center",children:"Memuat data..."})}):((P=s==null?void 0:s.data)==null?void 0:P.length)>0?s.data.map((t,a)=>{var l;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:(r-1)*c+a+1}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.nama_lengkap}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.nik}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.nipd}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:((l=t==null?void 0:t.identities)==null?void 0:l.pendidikan)||"-"}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.village.name_bps||"-"}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:t.village.district.name_bps||"-"}),e.jsx("td",{className:"border px-2 py-2 whitespace-nowrap text-sm text-gray-500 text-center",children:e.jsx(X,{role:t.status})}),e.jsx("td",{className:"border px-2 py-2 whitespace-nowrap text-sm text-gray-500 text-center",children:e.jsx(ie,{row:t,onAccept:$,onReject:A})}),e.jsx("td",{className:"px-2 py-2 border whitespace-nowrap",children:e.jsx(oe,{row:t,onEdit:_,onDelete:E,onView:M,onPrint:T,role:K})})]},t.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-4 text-center",children:"Tidak ada data yang ditemukan"})})})]})}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mt-4",children:[e.jsxs("div",{className:"mb-2 md:mb-0 flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("select",{id:"rowsPerPage",value:c,onChange:G,className:"border rounded",children:[5,10,25,50,100].map(t=>e.jsx("option",{value:t,children:t},t))})}),e.jsxs("span",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-medium",children:(r-1)*c+1})," ","-"," ",e.jsx("span",{className:"font-medium",children:Math.min(r*c,(s==null?void 0:s.total)||0)})," ","Total"," ",e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.total)||0})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>N(r-1),disabled:r===1,className:"px-3 py-1 border rounded disabled:opacity-50 bg-green-700 text-white",children:e.jsx(re,{})}),Array.from({length:Math.ceil(((s==null?void 0:s.total)||0)/c)},(t,a)=>a+1).slice(Math.max(0,r-3),Math.min(Math.ceil(((s==null?void 0:s.total)||0)/c),r+2)).map(t=>e.jsx("button",{onClick:()=>N(t),className:`px-3 py-1 border rounded ${r===t?"bg-green-700 text-white opacity-50":""}`,children:t},t)),e.jsx("button",{onClick:()=>N(r+1),disabled:r===Math.ceil(((s==null?void 0:s.total)||0)/c),className:"px-3 py-1 border rounded disabled:opacity-50 bg-green-700 text-white",children:e.jsx(ne,{})})]})})]})]})}export{ye as default};
