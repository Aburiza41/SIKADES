import{r as p,j as e,a as G}from"./app-cnLqKnWv.js";import{H as T,a as P,g as h,b as U,c as H,f as z,j as J,i as K,d as Y,e as $}from"./index-CyDsHmf4.js";import{u as D,b as V}from"./index-sj701c6h.js";import{S as W}from"./react-select.esm-kjDh-dq3.js";import{S as r}from"./sweetalert2.esm.all-LHqzTR4y.js";import{m as n}from"./proxy-0toHJmZX.js";import{A as X}from"./index-CSb7vC3W.js";import"./iconBase-CMF4PMHw.js";import"./defineProperty-DRmM3rRU.js";import"./typeof-QjJsDpFa.js";import"./index-c6l4leOc.js";import"./floating-ui.dom-CHZBHl4C.js";const q={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,when:"beforeChildren",staggerChildren:.1}}},o={hidden:{opacity:0,x:-10},visible:{opacity:1,x:0,transition:{duration:.3}},focus:{scale:1.02,boxShadow:"0 0 0 2px rgba(59, 130, 246, 0.5)"}},A={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.3}}};function de({trainings:N=[],setTrainings:F=()=>{},officialTrainings:c=[],setOfficialTrainings:b=()=>{}}){const[I,w]=p.useState(!1),[v,B]=p.useState(""),[d,m]=p.useState(null),[s,x]=p.useState({nama:"",tempat:"",pelatihan:"",penyelenggara:"",nomor:"",tanggal:"",docScan:null}),[g,y]=p.useState(null),[k,E]=p.useState([]),S=[...N.map(a=>({value:a.id,label:a.title})),...k],j=(a=null)=>{if(a!==null){const t=c[a];m({value:t.pelatihan_id||t.pelatihan,label:t.pelatihan_title||t.pelatihan}),x({nama:t.nama,tempat:t.tempat,pelatihan:t.pelatihan,penyelenggara:t.penyelenggara,nomor:t.nomor,tanggal:t.tanggal,docScan:t.doc_scan||null}),y(a)}else m(null),x({nama:"",tempat:"",pelatihan:"",penyelenggara:"",nomor:"",tanggal:"",docScan:null}),y(null);w(!0)},C=()=>{w(!1),m(null),x({nama:"",tempat:"",pelatihan:"",penyelenggara:"",nomor:"",tanggal:"",docScan:null}),y(null)},u=a=>{const{name:t,value:i}=a.target;x(l=>({...l,[t]:i}))},_=()=>{if(!d||!s.nama||!s.penyelenggara||!s.tempat){r.fire({icon:"error",title:"Oops...",text:"Harap isi semua field yang diperlukan!",background:"#ffffff"});return}const a={pelatihan_id:typeof d.value=="string"?null:d.value,pelatihan_title:d.label,nama:s.nama,tempat:s.tempat,pelatihan:d.label,penyelenggara:s.penyelenggara,nomor:s.nomor,tanggal:s.tanggal,doc_scan:s.docScan};if(g!==null){const t=[...c];t[g]=a,b(t),f("Data pelatihan berhasil diperbarui.")}else b([...c,a]),f("Data pelatihan berhasil ditambahkan.");C()},f=a=>{r.fire({title:"Berhasil!",text:a,icon:"success",iconColor:"#10b981",confirmButtonColor:"#3b82f6",background:"#ffffff"})},M=a=>{r.fire({title:"Apakah Anda yakin?",text:"Data yang dihapus tidak dapat dikembalikan!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3b82f6",cancelButtonColor:"#ef4444",confirmButtonText:"Ya, hapus!",cancelButtonText:"Batal",background:"#ffffff",iconColor:"#f59e0b"}).then(t=>{if(t.isConfirmed){const i=c.filter((l,O)=>O!==a);b(i),f("Data telah dihapus.")}})},R=async a=>{if(S.some(i=>i.label.toLowerCase()===a.toLowerCase())){r.fire({icon:"info",title:"Pelatihan sudah ada",text:"Pelatihan ini sudah tersedia di daftar pilihan",background:"#ffffff"});return}try{const i=await G.post("/village/official/training/store",{title:a,description:"Ditambahkan secara otomatis dari input pencarian"});if(i.data.success){const l={id:i.data.data.id,title:i.data.data.title,description:i.data.data.description};F([...N,l]),m({value:l.id,label:l.title}),f("Pelatihan baru berhasil ditambahkan")}}catch(i){console.error("Gagal menambahkan pelatihan:",i);const l={label:a,value:`temp-${Date.now()}`};E([...k,l]),m(l),r.fire({icon:"warning",title:"Pelatihan ditambahkan sementara",text:"Pelatihan ini belum tersimpan di database. Silakan tambahkan melalui menu 'Jenis Pelatihan' untuk menyimpan permanen.",background:"#ffffff"})}},L=a=>{if(a.target.files&&a.target.files.length>0){const t=a.target.files[0];if(!["application/pdf","image/jpeg","image/png"].includes(t.type)){r.fire({icon:"error",title:"Error",text:"Hanya file PDF, JPEG, atau PNG yang diizinkan",background:"#ffffff"});return}if(t.size>5*1024*1024){r.fire({icon:"error",title:"Error",text:"Ukuran file maksimal 5MB",background:"#ffffff"});return}x(l=>({...l,docScan:t}))}};return e.jsxs(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white w-full p-6 shadow-lg rounded-xl mt-8 border border-gray-100",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center gap-4 pb-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(n.div,{animate:{rotate:[0,10,-10,0]},transition:{duration:.5},children:e.jsx(D,{className:"text-3xl text-blue-500"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"F. RIWAYAT PELATIHAN/BIMBINGAN TEKNIS/SOSIALISASI"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1 flex items-center",children:[e.jsx(T,{className:"mr-1 text-blue-500"}),"Formulir ini digunakan untuk mengisi riwayat pelatihan pejabat desa."]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsxs(n.button,{type:"button",onClick:()=>j(),whileHover:{scale:1.03},whileTap:{scale:.98},className:"px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 flex items-center text-sm font-medium shadow-md",children:[e.jsx(P,{className:"mr-2 text-lg"})," Tambah Riwayat"]})})]}),e.jsx(n.div,{variants:q,initial:"hidden",animate:"visible",className:"overflow-x-auto rounded-lg border border-gray-200 shadow-sm",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tempat"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pelatihan"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Penyelenggara"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nomor"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tanggal"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dokumen"}),e.jsx("th",{className:"px-2 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aksi"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.length>0?c.map((a,t)=>e.jsxs(n.tr,{className:"hover:bg-gray-50",variants:A,children:[e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm text-gray-800",children:a.nama}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm text-gray-800",children:a.tempat}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm text-gray-800",children:a.pelatihan}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm text-gray-800",children:a.penyelenggara}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm text-gray-800",children:a.nomor||"-"}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm text-gray-800",children:a.tanggal||"-"}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm text-gray-800",children:a.doc_scan?e.jsxs("a",{href:URL.createObjectURL(a.doc_scan),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[e.jsx(h,{className:"mr-1"}),"Lihat"]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-2 py-2 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(n.button,{type:"button",onClick:()=>j(t),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-3 py-1 bg-gradient-to-r from-amber-500 to-amber-600 text-white rounded-lg hover:from-amber-600 hover:to-amber-700 flex items-center text-xs shadow-sm",children:[e.jsx(U,{className:"mr-1"})," Edit"]}),e.jsxs(n.button,{type:"button",onClick:()=>M(t),whileHover:{scale:1.05},whileTap:{scale:.95},className:"px-3 py-1 bg-gradient-to-r from-red-500 to-red-600 text-white rounded-lg hover:from-red-600 hover:to-red-700 flex items-center text-xs shadow-sm",children:[e.jsx(H,{className:"mr-1"})," Hapus"]})]})})]},t)):e.jsx(n.tr,{variants:A,children:e.jsx("td",{colSpan:"8",className:"px-2 py-2 text-center",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-gray-400",children:[e.jsx(T,{className:"text-4xl mb-2 text-blue-200"}),e.jsx("p",{className:"text-sm font-medium",children:"Tidak ada data riwayat pelatihan."}),e.jsxs(n.button,{type:"button",onClick:()=>j(),whileHover:{scale:1.03},whileTap:{scale:.98},className:"mt-4 px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 flex items-center text-sm font-medium shadow-md",children:[e.jsx(P,{className:"mr-2"})," Tambah Riwayat"]})]})})})})]})})]}),e.jsx(X,{children:I&&e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/30 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsx(n.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},transition:{type:"spring",damping:25},className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-200",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[e.jsx(D,{className:"mr-2 text-blue-500"}),g!==null?"Edit Riwayat Pelatihan":"Tambah Riwayat Pelatihan"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs(n.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1},className:"col-span-2",children:[e.jsxs("label",{className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[e.jsx(h,{className:"mr-2 text-blue-500"}),"Jenis Pelatihan"]}),e.jsx(n.div,{whileFocus:"focus",variants:o,children:e.jsx(W,{options:S,value:d,onChange:m,onInputChange:B,onKeyDown:a=>{a.key==="Enter"&&v.trim()&&(R(v),a.preventDefault())},placeholder:"Pilih Pelatihan atau ketik untuk menambahkan baru",isClearable:!0,isSearchable:!0,noOptionsMessage:()=>"Tidak ada opsi, tekan Enter untuk menambahkan",className:"basic-single",classNamePrefix:"select",styles:{control:a=>({...a,minHeight:"42px",borderColor:"#d1d5db","&:hover":{borderColor:"#d1d5db"},borderRadius:"0.5rem",boxShadow:"none","&:focus-within":{boxShadow:"0 0 0 2px rgba(59, 130, 246, 0.5)",borderColor:"transparent"}})}})})]}),e.jsxs(n.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.2},children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[e.jsx(z,{className:"mr-2 text-blue-500"}),"Nama"]}),e.jsx(n.input,{type:"text",name:"nama",value:s.nama,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Nama",whileFocus:"focus",variants:o})]}),e.jsxs(n.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.3},children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[e.jsx(J,{className:"mr-2 text-blue-500"}),"Tempat"]}),e.jsx(n.input,{type:"text",name:"tempat",value:s.tempat,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Tempat",whileFocus:"focus",variants:o})]}),e.jsxs(n.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.4},children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[e.jsx(V,{className:"mr-2 text-blue-500"}),"Penyelenggara"]}),e.jsx(n.input,{type:"text",name:"penyelenggara",value:s.penyelenggara,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Penyelenggara",whileFocus:"focus",variants:o})]}),e.jsxs(n.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.5},children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[e.jsx(h,{className:"mr-2 text-blue-500"}),"Nomor"]}),e.jsx(n.input,{type:"text",name:"nomor",value:s.nomor,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Nomor",whileFocus:"focus",variants:o})]}),e.jsxs(n.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.6},children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[e.jsx(K,{className:"mr-2 text-blue-500"}),"Tanggal"]}),e.jsx(n.input,{type:"date",name:"tanggal",value:s.tanggal,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",whileFocus:"focus",variants:o})]}),e.jsxs(n.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.7},className:"col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center",children:[e.jsx(h,{className:"mr-2 text-blue-500"}),"Dokumen"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n.input,{type:"file",onChange:L,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",accept:".pdf,.jpg,.jpeg,.png",whileFocus:"focus",variants:o}),s.docScan&&e.jsx("button",{onClick:()=>x(a=>({...a,docScan:null})),className:"p-2 text-red-500 hover:text-red-700",title:"Hapus dokumen",children:e.jsx(H,{})})]}),s.docScan&&e.jsxs("div",{className:"mt-2 flex items-center text-sm text-gray-600",children:[e.jsx(h,{className:"mr-2"}),e.jsx("span",{children:s.docScan.name}),e.jsxs("span",{className:"ml-2 text-gray-400",children:["(",(s.docScan.size/1024).toFixed(1)," ","KB)"]})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[e.jsxs(n.button,{type:"button",onClick:C,whileHover:{scale:1.03},whileTap:{scale:.98},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors flex items-center",children:[e.jsx(Y,{className:"mr-2"})," Batal"]}),e.jsxs(n.button,{type:"button",onClick:_,whileHover:{scale:1.03},whileTap:{scale:.98},className:"px-4 py-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 transition-colors flex items-center shadow-md",children:[e.jsx($,{className:"mr-2"}),g!==null?"Simpan Perubahan":"Simpan"]})]})]})})})})]})}export{de as default};
